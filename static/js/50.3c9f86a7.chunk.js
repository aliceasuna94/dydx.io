(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{2128:function(e,t,a){"use strict";var n=a(0),r=a.n(n),l=a(1),s=a.n(l),c=a(31);const o=({symbol:e,noColor:t})=>{switch(e){case"ETH":case"WETH":return r.a.createElement(c.z,null);case"SAI":return r.a.createElement(c.u,null);case"USDC":return r.a.createElement(c.ob,null);case"DAI":return r.a.createElement(c.u,null);case"BTC":return t?r.a.createElement(c.k,null):r.a.createElement(c.j,null);case"USDT":return r.a.createElement(c.pb,null);case"LINK":return r.a.createElement(c.M,null);default:return null}};o.propTypes={symbol:s.a.string.isRequired,noColor:s.a.bool};var i=o;a.d(t,"a",function(){return i})},2458:function(e,t,a){},2512:function(e,t,a){"use strict";a.r(t);var n=a(55),r=a.n(n),l=a(39),s=a.n(l),c=a(4),o=a.n(c),i=a(0),d=a.n(i),u=a(1),m=a.n(u),p=a(60),b=a(52),g=a(19),O=a.n(g),y=a(74),E=a(2128),w=a(617),h=a(2144),A=a(2123),k=a(2135),S=a(622),j=a(79),f=a(344),M=a(618),I=a(49),R=a(26),B=a(102),T=a(33),N=a(42),v=a(61),C=a(297),_=a(5),L=a(57),P=a(170),q=a(10),Y=a(191),x=a(391),D=a(2);a(2458);function asyncGeneratorStep(e,t,a,n,r,l,s){try{var c=e[l](s),o=c.value}catch(i){return void a(i)}c.done?t(o):Promise.resolve(o).then(n,r)}function _asyncToGenerator(e){return function(){var t=this,a=arguments;return new Promise(function(n,r){var l=e.apply(t,a);function _next(e){asyncGeneratorStep(l,n,r,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(l,n,r,_next,_throw,"throw",e)}_next(void 0)})}}function ownKeys(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(a,!0).forEach(function(t){_defineProperty(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ownKeys(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const G={loading:!1,didSetAllowance:!1,inputValue:"",error:null,amount:D.a.ZERO};class W extends i.Component{constructor(e){var t;super(e),t=this,this.onChangeInput=((e,t)=>{this.setState({amount:e,inputValue:t})}),this.onChangeSelectedMarket=(e=>{const t=this.props.getMarketById;this.setState(_objectSpread({},G,{selectedMarket:t(e)}))}),this.onClickMax=(()=>{const e=this.props,t=e.getWalletBalance,a=e.getIsEth,n=e.isRepay,r=this.state.selectedMarket,l=a(r),s=t(r),c=this.getSelectedMarketAccountBalance(),o=Object(q.a)(c.wei);let i=s;n?o.abs().gt(s)?(i=s,l&&(i=s.minus(D.c))):i=o.abs():(i=s,l&&(i=s.minus(D.c)));const d=Object(Y.e)(i,r.currency.decimals);this.setState({amount:i,inputValue:d})}),this.onClickCta=_asyncToGenerator(function*(){const e=t.props,a=e.isRepay,n=e.walletAddress,r=e.walletType,l=e.getDepositFromAddress,s=e.closeModal,c=e.setAllowance,o=e.deposit,i=e.stringGetter,d=t.state,u=d.amount,m=d.selectedMarket,p=l(m);if(!t.isAllowanceSet()){t.setState({loading:!0,didSetAllowance:!0});try{yield c(m.currency.contractAddress,n)}catch(g){return void t.setState({loading:!1,didSetAllowance:!1})}return void t.setState({loading:!1})}t.setState({loading:!0});const b=t.getIsRepayAll();try{yield o({depositFromAddress:p,market:m,accountNumber:N.b,amount:u,walletAddress:n,walletType:r,repayAll:a&&b,isRepay:a}),s()}catch(O){const e=Object(P.j)({error:O,walletAddress:n,walletType:r,location:"deposit-modal",stringGetter:i}).message;t.setState({loading:!1,error:e})}}),this.state=_objectSpread({},G,{selectedMarket:e.market||o()(e,"markets[0]")})}getSelectedMarketAccountBalance(){const e=this.props.marginAccount,t=this.state.selectedMarket;return Object(B.b)({account:e,market:t})}isAllowanceSet(){const e=this.props,t=e.getTokenProtocolAllowance,a=e.getIsEth,n=this.state.selectedMarket,r=a(n),l=t(n);return r||l.gt(0)}getIsRepayAll(){const e=this.state,t=e.inputValue,a=e.selectedMarket,n=this.getSelectedMarketAccountBalance();return t===Object(Y.e)(Object(q.a)(n.wei).abs(),a.currency.decimals)}isDepositEnabled(){const e=this.state,t=e.amount,a=e.selectedMarket,n=this.props,r=n.walletAddress,l=n.getWalletBalance,s=(0,n.getIsEth)(a),c=l(a);return!this.isAllowanceSet()||!!r&&(!t.gt(c)&&((!s||!t.gt(c.minus(D.c)))&&!!t.gt(D.a.ZERO)))}renderInterestRateLineItem(){const e=this.props.stringGetter,t=this.state,a=t.inputValue,n=t.amount,r=t.selectedMarket,l=r.totalBorrowAPR,s=r.totalSupplyAPR,c=r.currency,o=Object(q.a)(this.getSelectedMarketAccountBalance().wei),i=a===Object(Y.e)(o.abs(),c.decimals)?D.a.ZERO:o.plus(n),u=Object(q.a)(s).times(100).toFixed(v.d),m=Object(q.a)(l).times(100).toFixed(v.d);let p;p=o.eq(0)?"-":o.gt(0)?d.a.createElement("div",{className:"green"},e({key:_.a.EARNING})," ",u,"%"):d.a.createElement("div",{className:"red"},e({key:_.a.PAYING})," ",m,"%");const b=e({key:_.a.INTEREST_RATE_APR});if(i.eq(0))return d.a.createElement(j.g,{title:b},d.a.createElement(w.b,{afterText:n.gt(0)&&"-",arrow:n.gt(0)&&"grey"},p));if(i.lt(0))return d.a.createElement(j.g,{title:b},p);const g=n.gt(0)&&o.lte(0);return d.a.createElement(j.g,{title:b},d.a.createElement(w.b,{afterText:g&&d.a.createElement("div",{className:"green"},"Earn ",u,"% APR"),arrow:g&&"green"},p))}render(){const e=this.props,t=e.balancesWithOutstandingBorrow,a=e.closeModal,n=e.collateralization,l=e.getIsEth,c=e.getNewCollateralization,o=e.getTokenProtocolAllowance,i=e.getWalletBalance,u=e.hasBorrowsInMainAccount,m=e.isRepay,p=e.isWalletInvalid,b=e.markets,g=e.stringGetter,y=e.walletAddress,I=e.walletAddressShort,B=e.walletType,T=this.state,N=T.inputValue,P=T.amount,G=T.error,W=T.loading,z=T.didSetAllowance,F=T.selectedMarket,V=l(F),K=o(F),Z=i(F),H=Object(q.a)(this.getSelectedMarketAccountBalance().wei),U=F.symbol,J=F.currency,$=N===Object(Y.e)(H.abs(),J.decimals),Q=Object(Y.e)(Z,J.decimals),X=Object(Y.e)(H,J.decimals),ee=$?D.a.ZERO:H.plus(P),te=this.getIsRepayAll()?v.o:Object(Y.e)(ee,J.decimals),ae=Z.minus(P),ne=Object(Y.e)(ae,J.decimals),re=$&&1===s()(t)?Object(q.a)(1/0):c(new L.a(P,F));let le="Not Connected";y&&!p&&(le=`${Object(x.b)(B)||"None"} ${I}`);let se=g({key:_.a.DEPOSIT_EARN_INTEREST_SYMBOL,params:{SYMBOL:U}}),ce=g({key:_.a.DEPOSIT});m&&(H.lt(0)?(se=g({key:_.a.REPAY_SYMBOL,params:{SYMBOL:U}}),ce=g({key:_.a.REPAY})):se=g({key:_.a.DEPOSIT_SYMBOL,params:{SYMBOL:U}})),this.isAllowanceSet()||(ce=g({key:_.a.ENABLE_SYMBOL,params:{SYMBOL:U}}));let oe=G;return oe||p||(P.gt(Z)?oe=g({key:_.a.INSUFFICIENT_SYMBOL_BALANCE,params:{SYMBOL:U}}):V&&P.gt(Z.minus(D.c))&&(oe=g({key:_.a.DOES_NOT_LEAVE_ENOUGH_ETH}))),d.a.createElement("div",{className:"component-deposit"},d.a.createElement(f.c,null,d.a.createElement(j.d,null,se),d.a.createElement("div",{className:"dropdown-container"},d.a.createElement(k.b,{selectedItemKey:F.id,onChangeSelection:this.onChangeSelectedMarket,menuItems:r()(C.c,e=>{const t=Object(R.c)({allMarkets:b,symbol:e}),a=t.id,n=t.symbol;return{key:a,label:d.a.createElement("div",{className:"dropdown-label"},d.a.createElement("div",{className:"token-icon"},d.a.createElement(E.a,{symbol:n})),n)}})})),d.a.createElement(j.b,null,d.a.createElement("div",{className:O()("wallet-info",{red:!I||p})},y&&d.a.createElement(S.a,{walletType:B}),le),d.a.createElement(j.g,{title:g({key:_.a.AVAILABLE_SYMBOL,params:{SYMBOL:F.symbol}}),red:P.gt(Z)},d.a.createElement(w.b,{afterText:P.gt(0)&&ae.gte(0)&&ne,arrow:P.gt(0)&&ae.gte(0)&&"red"},Q))),d.a.createElement(A.a,{top:-50,left:40,tooltip:"deposit-allowance",condition:!this.isAllowanceSet(),stringParams:{SYMBOL:F.symbol}},d.a.createElement(M.a,{market:F,onClickMax:this.onClickMax,disabled:W||!this.isAllowanceSet(),value:N,onChange:this.onChangeInput})),d.a.createElement(j.g,{title:g({key:_.a.MARGIN_BALANCE_SYMBOL,params:{SYMBOL:F.symbol}})},d.a.createElement(w.b,{afterText:P.gt(0)&&te,arrow:P.gt(0)&&"green"},X)),u&&d.a.createElement(j.g,{title:g({key:_.a.COLLATERALIZATION})},d.a.createElement(w.b,{afterText:P.gt(0)&&n.isFinite()&&d.a.createElement(h.b,{className:"collateralization",collateralization:re}),arrow:P.gt(0)&&n.isFinite()&&"green"},d.a.createElement(h.b,{className:"collateralization",collateralization:n}))),!m&&this.renderInterestRateLineItem(),oe?d.a.createElement(j.a,null,oe):null),d.a.createElement(f.b,null,d.a.createElement(f.a,{onClick:a},g({key:_.a.CANCEL})),d.a.createElement(f.a,{disabled:!this.isDepositEnabled(),onClick:this.onClickCta,green:!0,loading:W||z&&K.lte(0)},ce)))}}W.propTypes={balancesWithOutstandingBorrow:m.a.object.isRequired,closeModal:m.a.func.isRequired,collateralization:m.a.object,deposit:m.a.func.isRequired,getDepositFromAddress:m.a.func.isRequired,getIsEth:m.a.func.isRequired,getMarketById:m.a.func.isRequired,getNewCollateralization:m.a.func.isRequired,getTokenProtocolAllowance:m.a.func.isRequired,getWalletBalance:m.a.func.isRequired,hasBorrowsInMainAccount:m.a.bool.isRequired,isRepay:m.a.bool,isWalletInvalid:m.a.bool.isRequired,marginAccount:m.a.object,market:m.a.object,markets:m.a.array.isRequired,setAllowance:m.a.func.isRequired,stringGetter:m.a.func.isRequired,walletAddress:m.a.string,walletAddressShort:m.a.string,walletType:m.a.string};var z=Object(y.k)(Object(b.c)(e=>({balancesWithOutstandingBorrow:Object(B.j)(e),collateralization:Object(B.n)(e),getDepositFromAddress:t=>Object(T.c)(e,t),getIsEth:e=>Object(R.h)(e),getMarketById:t=>Object(R.f)(e,t),getNewCollateralization:t=>Object(B.u)(e,[t]),getTokenProtocolAllowance:t=>Object(R.g)(e,t),getWalletBalance:t=>Object(T.n)(e,t),hasBorrowsInMainAccount:Object(B.k)(e),isWalletConnected:Object(T.u)(e),isWalletInvalid:Object(T.v)(e),marginAccount:Object(B.r)(e),markets:Object(R.d)(e),walletAddress:Object(T.m)(e),walletAddressShort:Object(T.l)(e),walletType:Object(T.q)(e)}),e=>Object(p.b)({deposit:I.a,setAllowance:I.c},e))(W));a.d(t,"default",function(){return z})}}]);