(window.webpackJsonp=window.webpackJsonp||[]).push([[35,11,15],{2122:function(e,t,a){"use strict";a.d(t,"b",function(){return d}),a.d(t,"c",function(){return u}),a.d(t,"d",function(){return p}),a.d(t,"a",function(){return m});var r=a(4),i=a.n(r),n=a(41),l=a(44),o=a(26),s=a(94),c=a(10);const d=e=>i()(e,"indexPrices.indexPrices"),u=e=>i()(e,"indexPrices.areIndexPricesLoaded"),p=Object(n.a)([l.e,d,o.d],(e,t,a)=>m({pair:e,allIndexPrices:t,allMarkets:a})),m=({pair:e,allIndexPrices:t,allMarkets:a})=>{const r=e.orderMarket,i=e.baseSymbol,n=e.quoteSymbol,l=Object(o.c)({allMarkets:a,symbol:i}),d=Object(o.c)({allMarkets:a,symbol:n}),u=t[r];if(u)return new s.a(u,l,d).getNaturalValue();const p=Object(o.c)({allMarkets:a,symbol:"DAI"});if(p&&p.oraclePrice){if("WETH-DAI"===r){if(t["WETH-USDC"])return new s.a(t["WETH-USDC"],l,Object(o.c)({allMarkets:a,symbol:"USDC"})).getNaturalValue().div(p.oraclePrice)}if("DAI-USDC"===r)return Object(c.a)(p.oraclePrice)}return null}},2125:function(e,t,a){e.exports={loadingDots:"_3jMPchhhIOb4dZOy6GLdPk",dot:"_2f58i9-DZX4n6MkcSDUG0","dot-keyframes":"j0RjL1ZlcGTCa4Xjy9tyY",newLoadingDots:"oppLNwiDeV9-rzLw4k37w","dot-animation":"_15KINsZKdzjYj3pK_pSvRH",compact:"_1WWoQQoq0KrhJIG9Mb9dfZ"}},2126:function(e,t,a){var r=a(921),i=a(619),n=a(385),l=9007199254740991,o=4294967295,s=Math.min;e.exports=function times(e,t){if((e=n(e))<1||e>l)return[];var a=o,c=s(e,o);t=i(t),e-=o;for(var d=r(c,t);++a<e;)t(a);return d}},2132:function(e,t,a){"use strict";var r=a(2126),i=a.n(r),n=a(0),l=a.n(n),o=a(1),s=a.n(o),c=a(2125),d=a.n(c);const u=({size:e=2})=>l.a.createElement("div",{className:d.a.loadingDots,style:{width:3*e+8}},i()(3,t=>l.a.createElement("div",{key:t,className:d.a.dot,style:{height:e,width:e}})));u.propTypes={size:s.a.number};var p=u,m=a(19),b=a.n(m);const g=({compact:e})=>l.a.createElement("div",{className:b()(d.a.newLoadingDots,{[d.a.compact]:e})});g.propTypes={compact:s.a.bool};var O=g;a.d(t,"b",function(){return p}),a.d(t,"a",function(){return O})},2143:function(e,t,a){"use strict";var r=a(231),i=a.n(r),n=a(0),l=a.n(n),o=a(1),s=a.n(o),c=a(19),d=a.n(c),u=a(2149),p=a.n(u);const m=({className:e,label:t,labelClassName:a,checked:r,onClick:n,topAlignedCheckbox:o})=>l.a.createElement("div",{className:d()(p.a.checkboxWrapper,e)},l.a.createElement("div",{className:p.a.checkbox,role:"button",tabIndex:0,onClick:n},l.a.createElement("input",{type:"checkbox",checked:r,onChange:i.a}),l.a.createElement("span",{className:d()(p.a.custom,{[p.a.topAligned]:o})}),t&&l.a.createElement("div",{className:d()(p.a.label,a)},t)));m.propTypes={checked:s.a.bool,className:s.a.string,label:s.a.oneOfType([s.a.arrayOf(s.a.node),s.a.node,s.a.string]),labelClassName:s.a.string,onClick:s.a.func.isRequired,topAlignedCheckbox:s.a.bool};var b=m;a.d(t,"a",function(){return b})},2144:function(e,t,a){"use strict";var r=a(55),i=a.n(r),n=a(0),l=a.n(n),o=a(1),s=a.n(o),c=a(19),d=a.n(c),u=a(191),p=a(2161),m=a.n(p);const b={SMALL:"SMALL",LARGE:"LARGE"},g=({className:e,collateralization:t,size:a,red:r,suffix:i})=>l.a.createElement("div",{className:d()(m.a.collateralization,e,{[m.a.red]:r,[m.a.small]:a===b.SMALL,[m.a.large]:a===b.LARGE})},Object(u.d)(t)||l.a.createElement("div",{className:d()(m.a.infinite,{[m.a.withSuffix]:i})},"\u221e")," ",i);g.propTypes={className:s.a.string,collateralization:s.a.object,size:s.a.oneOf(i()(b,e=>e)),red:s.a.bool,suffix:s.a.string},g.defaultProps={size:b.LARGE};var O=g;a.d(t,"b",function(){return O}),a.d(t,"a",function(){return b})},2146:function(e,t,a){},2149:function(e,t,a){e.exports={checkboxWrapper:"vNRaxmHo46U6RappONKFH",checkbox:"_19RMSXPBlUqYk12l-xPHYr",custom:"_2kl9Enu9XNPp7I5yxjjUlj",topAligned:"_3mLmd2r1moWl1-lllnQKfj",label:"_2h1JC1J1RFcB8X-C9rrGQk"}},2150:function(e,t,a){e.exports={animatedToggle:"_2uX6PC8cA8YPCtdcDGUDVn",toggled:"_3NWbtL9arP0Eum-jEVhUtn",grayscale:"_4TrMjUnhys9QgRpb_qejA",label:"_3pd4To_unYOQ9_wOU2cXJO",compact:"_2cnM-EVr5tBuRyrxovo9uS"}},2152:function(e,t,a){"use strict";var r=a(0),i=a.n(r),n=a(1),l=a.n(n),o=a(52),s=a(60),c=a(19),d=a.n(c),u=a(74),p=a(384),m=a(190),b=a(45),g=a(33),O=a(44),y=a(296),T=a(102),k=a(24),E=a(5),h=a(38);a(2146);const f=({areAccountsLoaded:e,arePerpBalancesLoaded:t,arePerpMarketsLoaded:a,currentPair:{type:r},isBorrowPage:n,isPerpPage:l,isTradePage:o,isWalletConnecting:s,isWalletIncorrectNetwork:c,isWalletInvalid:u,isWalletReady:b,openModal:g,stringGetter:O,withBorder:y})=>{const T=d()("component-sidebar-wallet-ctas",{"component-sidebar-wallet-ctas__with-border":y,"component-sidebar-wallet-ctas__trade":o,"component-sidebar-wallet-ctas__perp":l,"component-sidebar-wallet-ctas__spot":!n&&r===k.d.SPOT});return c?i.a.createElement("div",{className:T},i.a.createElement("div",{className:"cta-content"},O({key:E.a.CHANGE_NETWORK_REQUEST}))):!s&&u?i.a.createElement("div",{className:T},i.a.createElement("div",{className:"cta-content"},O({key:E.a.GET_STARTED_DESCRIPTION})),i.a.createElement("div",null,i.a.createElement(m.g,{blue:!0,className:"connect-wallet-button",onClick:()=>g({type:h.a.CONNECT_WALLET})},O({key:E.a.CONNECT_WALLET})))):!s&&b&&(l?a&&t:e)?null:i.a.createElement("div",{className:T},i.a.createElement("div",{className:"cta-content"},i.a.createElement(p.a,null)))};f.defaultProps={withBorder:!0},f.propTypes={areAccountsLoaded:l.a.bool.isRequired,arePerpBalancesLoaded:l.a.bool.isRequired,arePerpMarketsLoaded:l.a.bool.isRequired,currentPair:l.a.object.isRequired,isBorrowPage:l.a.bool,isPerpPage:l.a.bool,isTradePage:l.a.bool,isWalletConnecting:l.a.bool.isRequired,isWalletIncorrectNetwork:l.a.bool.isRequired,isWalletInvalid:l.a.bool.isRequired,isWalletReady:l.a.bool.isRequired,openModal:l.a.func.isRequired,stringGetter:l.a.func.isRequired,withBorder:l.a.bool};var P=Object(u.k)(Object(o.c)(e=>({areAccountsLoaded:Object(T.i)(e),arePerpBalancesLoaded:Object(y.c)(e),arePerpMarketsLoaded:Object(y.d)(e),currentPair:Object(O.e)(e),isWalletConnecting:Object(g.e)(e),isWalletIncorrectNetwork:Object(g.f)(e),isWalletInvalid:Object(g.g)(e),isWalletReady:Object(g.h)(e)}),e=>Object(s.b)({openModal:b.c},e))(f));a.d(t,"a",function(){return P})},2153:function(e,t,a){"use strict";var r=a(0),i=a.n(r),n=a(1),l=a.n(n),o=a(19),s=a.n(o),c=a(2150),d=a.n(c);const u=({className:e,compact:t,grayscale:a,isToggledRight:r,leftLabel:n,onClickLeft:l,onClickRight:o,rightLabel:c})=>i.a.createElement("div",{className:s()(d.a.animatedToggle,{[d.a.toggled]:r,[d.a.grayscale]:a,[d.a.compact]:t},e)},i.a.createElement("div",{role:"button",tabIndex:0,className:d.a.label,onClick:l},n),i.a.createElement("div",{role:"button",tabIndex:0,className:d.a.label,onClick:o},c));u.propTypes={className:l.a.string,compact:l.a.bool,grayscale:l.a.bool,isToggledRight:l.a.bool,leftLabel:l.a.oneOfType([l.a.string,l.a.node]).isRequired,onClickLeft:l.a.func.isRequired,onClickRight:l.a.func.isRequired,rightLabel:l.a.oneOfType([l.a.string,l.a.node]).isRequired};var p=u;a.d(t,"a",function(){return p})},2161:function(e,t,a){e.exports={collateralization:"_3Jjxqc_v5i6Sl5-pDI7v7m",red:"_2gfHkqdC0ZUKvmVSopFplt",withSuffix:"_2p_GsP7NpEmOIJxEpIcqvQ",infinite:"_1nKenGGt0Xnppcydfg8wMl",small:"wO275Y596ZIW4aEBgpYmG",large:"_3GPX8iSGVCnbO9zOBVdBHr"}},2163:function(e,t,a){e.exports={dropdown:"_1bDdh5nYnDoQPasNegtesO",pairEntry:"MlQzEhmgD54Z_7Vjdkg4v",marketNameIcon:"_2CGihejg78xcuReXJ-I4A-",marketIcon:"_1PT28MDH5ajkWUdca3wUDH",marketIconPerp:"_3jFoxkwsboUZdn84dSmw9N",priceContainer:"_3thVNRhdg-9vUsxPkS5Sr5",changeContainer:"_3KJb-Ugk3JWSc16uCwq8pt",percentChange:"_20wHTcDc9-9tMSTIZRhukZ",green:"_1ofSXY8MpqyE8wBB-Bf0qf",red:"_3mgukL4c2j2iQUlH7zk3gT",selectedEntryCheck:"NriznvnNx5anjGeVLd89P"}},2164:function(e,t,a){e.exports={selectMarket:"_3VTmhdaPb6jsKr_xWs7O4s",selectMarketButtonDropdown:"_2c9nPvfS0xREcVBT0UV0Th",selectMarketButton:"_3otHCMFe5i-y9MuVHLnwDT",buttonDropdownOpen:"_2ukGPwyHMU-X7PDKk9KVqn",symbol:"_1KyaoMW9ey14gBxUpsnhIP",symbolLeft:"lKQgak8Xz8OZwGwLy9zAk",marketIcon:"a02BZ1WRbWeqd9OIqZGPr",marketIconPerp:"_2Y49FczbTgR88wNJXMmWr2"}},2165:function(e,t,a){e.exports={productUnavailable:"_1CMeWrBVL3aPcbGjV1gSxC",text:"_2SOpRg2GW_SfGzHF_c4h-A"}},2166:function(e,t,a){e.exports={perpetualLeverageSlider:"_1U7TbKmmnqSpgqUSMzMGnl",leverageLabel:"_3SS4uL0oiVJ95ZZpN8c2MH",leverageBadge:"_24lBUpwb_4ulI1dQjyW5FW",leverageBadgeLong:"_1mSLMt9CMuA--sISM8xxbk",leverageBadgeShort:"_2DCxw1Av9qUfcCIT2PF7US",labels:"_2qMVcLKoCXviMD57PW0hHI",label:"aHAZB2Puou6lpxYWCzUnX",dots:"_3Exz7KbogeEsI9jsg4IV2y",dot:"_3hSuMH5NWlLCVFvsIPBpJ-"}},2167:function(e,t,a){e.exports={tradeReceipt:"_2yaua8HwORaH7jJ7NwfOj1",row:"VECzWHOu1NYOqt4QMDpJL",title:"_2yqVWTegM_6-T7pfXfUzhe",value:"lL-Ev8uaBnxL2usqFe_xi",red:"_V15lf8hBhJzUQHozGZEV",badge:"_1WITnQD-qzACgA3Tyha60u",badgeGradient:"QKC-IeLKiz2ZeiO1dkMvH"}},2168:function(e,t,a){},2169:function(e,t,a){e.exports={slidingTabs:"tlLiCocP8Y6yD1BqIOJOd",twoTabs:"_2AB8qMvzSs9mlUfRd9oyim",threeTabs:"_2r_2I2ObnCAflzw6yh_6uJ","selectedIndex--1":"_2YCmapsZytOs1cDrNdC9IW","selectedIndex--2":"_2OgA-aYVumFpXox1o6dCc8",tab:"_3YmH3d966IPzt4Sy5Nb5hD",selected:"_3Iu8gYmW-eRtXTaTMQkyMz"}},2170:function(e,t,a){e.exports={leverageGrid:"_1fb1gpofDClK2ZVyTFjtDH"}},2171:function(e,t,a){},2172:function(e,t,a){"use strict";var r=a(231),i=a.n(r),n=a(112),l=a.n(n),o=a(4),s=a.n(o),c=a(0),d=a.n(c),u=a(1),p=a.n(u),m=a(52),b=a(60),g=a(19),O=a.n(g),y=a(9),T=a.n(y),k=a(74),E=a(31),h=a(250),f=a(44),P=a(5),v=a(24),S=a(2165),R=a.n(S);const I=({currentPair:e,isUserInUsa:t,stringGetter:a})=>e.type===v.d.PERPETUAL&&t?d.a.createElement("div",{className:R.a.productUnavailable},d.a.createElement(E.a,null),d.a.createElement("div",{className:R.a.text},a({key:P.a.PERPETUAL_NOT_AVAILABLE})," ",a({key:P.a.MORE_DETAILS_TOS}),d.a.createElement("a",{href:"https://dydx.exchange/terms-of-use/",target:"_blank",rel:"noopener noreferrer"},d.a.createElement(E.ub,null)))):null;I.propTypes={currentPair:p.a.object.isRequired,isUserInUsa:p.a.bool.isRequired,stringGetter:p.a.func.isRequired};var M=Object(k.k)(Object(m.c)(e=>({currentPair:Object(f.e)(e),isUserInUsa:Object(h.c)(e)}))(I)),A=a(2126),_=a.n(A),N=a(621),D=a.n(N),L=a(2501),j=a(2500),C=a(2261),x=a(2123),w=a(2127),q=a(86),B=a(296),G=a(26),U=a(2122),W=a(343),F=a(132),V=a(171),Y=a(61),z=a(2),H=a(615),K=a(10),Z=a(46),Q=a(2166),X=a.n(Q);const $=Object(C.a)({rail:{height:6,background:"linear-gradient(90deg, #ff5757, #616774, #57ff5f)",opacity:1,borderRadius:4},thumb:{zIndex:1,marginTop:-3,backgroundColor:"#ffffff","&:hover":{boxShadow:"0 0 5px #959eb1"},"&:active":{boxShadow:"none"}},valueLabel:{top:8,fontSize:11,left:"calc(-50% - 12px)"}})(L.a),J=Object(C.a)({tooltip:{backgroundColor:"#17181a",margin:"8px 0",fontSize:11,fontFamily:"Roboto Mono"}})(j.a),ee=({children:e,open:t,value:a})=>d.a.createElement(J,{open:t,enterTouchDelay:0,placement:"bottom",title:a},e);class te extends c.Component{constructor(e){super(e),this.getPositionLeverage=(({amount:e,price:t,side:a}={})=>{const r=this.props,i=r.allIndexPrices,n=r.arePerpetualBalancesLoaded,l=r.currentPair,o=l.orderMarket,s=l.isInversePerpetual,c=r.perpetualBalances;if(!n)return z.a.ZERO;const d=c[o],u=d.margin,p=d.position,m=i[o];let b=Object(K.a)(p),g=Object(K.a)(u);if(e&&t&&a){const r=s?e.div(t.baseAmount):e.times(t.baseAmount);b=a===z.f.SELL?b.minus(e):b.plus(e),g=a===z.f.SELL?g.plus(r):g.minus(r)}const O=Object(H.c)({positionBN:b,marginBN:g,indexPrice:m,isInversePerpetual:s});return O||z.a.ZERO}),this.onChangeLeverage=((e,t)=>{const a=this.props,r=a.allIndexPrices,i=a.allMarkets,n=a.allOrderbookOrders,l=a.perpetualBalances,o=a.currentPair,s=a.setTradeData,c=o.orderMarket,d=o.isInversePerpetual,u=o.baseSymbol,p=o.quoteSymbol,m=l[c]||{},b=m.margin,g=m.position,O=r[c],y=Object(G.c)({allMarkets:i,symbol:d?p:u}),T=Object(K.a)(g),k=Object(K.a)(b);let E,h;d?(E=T,h=k.times(O)):(E=T.times(O),h=k);const f=Object(K.a)(t),P=this.getPositionLeverage();let v,S;v=f.gt(P)?f.times(E.plus(h)).minus(E):E.minus(f.times(E.plus(h))),d||(v=v.div(O)),S=d?f.gt(T.lt(0)?P:-1*P)?z.f.BUY:z.f.SELL:f.gt(T.gte(0)?P:-1*P)?z.f.BUY:z.f.SELL;let R=Object(F.a)({allOrderbookOrders:n,allMarkets:i,pair:o,side:S,amount:v});const I=this.getPositionLeverage({amount:v,price:R,side:S});R&&I&&!I.dp(Y.e).eq(f.abs())&&(v=d?R.baseAmount.times(f.times(h).plus(f.times(E)).plus(E)).div(f.times(R.baseAmount).plus(R.baseAmount).minus(f.times(O))):f.gt(P)?f.times(h.plus(E)).minus(E).div(R.baseAmount.times(f).minus(f.times(O)).plus(O)):f.abs().times(h.plus(E)).minus(E).div(f.minus(1).times(O).minus(R.baseAmount.times(f))),R=Object(F.a)({allOrderbookOrders:n,allMarkets:i,pair:o,side:S,amount:v.abs()})),s({amount:v.abs(),amountDisplayValue:Object(Z.a)(v,y.currency.decimals).toFixed(Y.n),selectedPerpetualLeverage:f,side:S,price:R})}),this.onChangeLeverage=D()(this.onChangeLeverage,100)}render(){const e=this.props,t=e.allIndexPrices,a=e.allMarkets,r=e.arePerpetualBalancesLoaded,i=e.arePerpetualMarketsLoaded,n=e.currentPair,o=e.currentTradeData,s=e.perpetualBalances,c=e.perpetualMarkets,u=e.stringGetter,p=n.maxLeverage,m=o.selectedPerpetualLeverage;let b=m;if(l()(b)&&r&&i){const e=Object(H.h)({allIndexPrices:t,allMarkets:a,currentPair:n,perpetualBalances:s,perpetualMarkets:c,currentTradeData:o}),r=e.positionLeverage,i=e.positionSide,l=e.newPositionLeverage,d=e.newPositionSide;b=e.hasOrderDiff?d===V.d.SHORT?l.negated():l:i===V.d.SHORT?r.negated():r}const g=[];return _()(11,e=>g.push(d.a.createElement("div",{key:e,className:X.a.dot}))),d.a.createElement(w.c,{label:d.a.createElement(x.a,{className:X.a.leverageLabel,top:8,left:-48,tooltip:"perpetual-leverage-slider"},u({key:P.a.LEVERAGE}),m&&!m.isZero()&&d.a.createElement("div",{className:O()(X.a.leverageBadge,{[X.a.leverageBadgeShort]:m.lt(0),[X.a.leverageBadgeLong]:m.gt(0)})},u({key:m.lt(0)?P.a.SHORT:P.a.LONG})))},d.a.createElement("div",{className:X.a.perpetualLeverageSlider},d.a.createElement($,{track:!1,ValueLabelComponent:ee,min:p.negated().toNumber(),max:p.toNumber(),step:.1,valueLabelFormat:e=>`${Math.abs(e).toFixed(Y.e)}\xd7`,value:b?b.toNumber():0,onChange:this.onChangeLeverage,valueLabelDisplay:"auto"}),d.a.createElement("div",{className:X.a.dots},g)),d.a.createElement("div",{className:X.a.labels},d.a.createElement("div",{className:X.a.label},p.toFixed(0),"\xd7"),d.a.createElement("div",{className:X.a.label},"0\xd7"),d.a.createElement("div",{className:X.a.label},p.toFixed(0),"\xd7")))}}te.propTypes={allIndexPrices:p.a.object.isRequired,allMarkets:p.a.array.isRequired,allOrderbookOrders:p.a.object.isRequired,arePerpetualBalancesLoaded:p.a.bool.isRequired,arePerpetualMarketsLoaded:p.a.bool.isRequired,currentPair:p.a.object.isRequired,currentTradeData:p.a.object.isRequired,perpetualBalances:p.a.object.isRequired,perpetualMarkets:p.a.object.isRequired,setTradeData:p.a.func.isRequired,stringGetter:p.a.func.isRequired};var ae=Object(k.k)(Object(m.c)(e=>({allIndexPrices:Object(U.b)(e),allMarkets:Object(G.d)(e),allOrderbookOrders:Object(F.d)(e),arePerpetualBalancesLoaded:Object(B.c)(e),arePerpetualMarketsLoaded:Object(B.d)(e),currentPair:Object(f.e)(e),currentTradeData:Object(W.b)(e),perpetualBalances:Object(B.e)(e),perpetualMarkets:Object(B.g)(e)}),e=>Object(b.b)({setTradeData:q.e},e))(te)),re=a(34),ie=a(232),ne=a(33),le=a(11),oe=a(150),se=a(57),ce=a(94),de=a(386),ue=a(614),pe=a(301),me=a(2167),be=a.n(me);const ge=({allPairOrderData:e,orderMarket:t,isPerpetual:a=!1})=>{const r=e[t]||{};return Object(Z.a)(r.smallOrderThreshold||0,a?r.decimals:s()(r,"baseCurrency.decimals",0))};class Oe extends c.Component{renderRow({title:e,value:t,tooltipConfig:{tooltip:a,top:r,left:i,stringParams:n,learnMoreLink:l}={}}){return t?d.a.createElement("div",{className:be.a.row},d.a.createElement("div",{className:be.a.title},a?d.a.createElement(x.a,{top:r,left:i,tooltip:a,stringParams:n,learnMoreLink:l},e):e),d.a.createElement("div",{className:be.a.value},t)):null}renderMarginDeposit(){const e=this.props,t=e.currentTradeData.marginDeposit,a=e.stringGetter;return t?this.renderRow({title:a({key:P.a.MARGIN_DEPOSIT}),value:`${t.getNaturalValue().toFixed(Y.n)} ${t.market.symbol}`,tooltipConfig:{tooltip:"margin-deposit",top:8,left:-48}}):null}renderTradeAmount(){const e=this.props,t=e.allPairOrderData,a=e.baseMarket,r=e.currentPair.orderMarket,i=e.currentTradeData.amount,n=e.selectedTradeType,l=e.stringGetter,o=e.tradeAmount,s=(t[r]||{}).minimumOrderSize,c=n===le.v.ISOLATED&&i&&!i.isZero()&&new se.a(o,a);return c&&this.renderRow({title:l({key:P.a.TRADE_AMOUNT}),value:d.a.createElement("div",{className:O()({[be.a.red]:c.baseAmount.lt(s)})},c.getNaturalValue().toFixed(Y.n)," ",c.market.symbol),tooltipConfig:{tooltip:"isolated-trade-amount",top:8,left:-48}})}renderExpectedPrice(){const e=this.props,t=e.currentPair,a=t.type,r=t.tickDecimals,i=t.displayQuoteSymbol,n=e.currentTradeData,l=n.tradeOrderType,o=n.price,s=e.selectedTradeType,c=e.stringGetter,d=(s===le.v.ISOLATED||a===v.d.PERPETUAL&&l===le.u.MARKET)&&o;return d&&d.baseAmount.isFinite()&&this.renderRow({title:c({key:P.a.EXPECTED_PRICE}),value:`${d.getNaturalValue().toFixed(r)} ${i}`,tooltipConfig:{tooltip:"slippage-expected-price",top:8,left:-48,learnMoreLink:"https://help.dydx.exchange/trading-faq/spread-price-impact-and-slippage"}})}renderIndexPrice(){const e=this.props,t=e.baseMarket,a=e.quoteMarket,r=e.currentPair,i=r.displayQuoteSymbol,n=r.tickDecimals,l=e.currentTradeData.tradeOrderType,o=e.indexPriceNatural,s=e.stringGetter,c=l===le.u.STOP&&ce.a.fromNaturalValue(o,t,a);return c&&c.baseAmount.isFinite()&&this.renderRow({title:s({key:P.a.INDEX_PRICE}),value:`${c.getNaturalValue().toFixed(n)} ${i}`,tooltipConfig:{tooltip:"index-price",top:8,left:-48}})}renderInitialStopPrice(){const e=this.props,t=e.currentPair,a=t.displayQuoteSymbol,r=t.tickDecimals,i=e.currentTradeData,n=i.triggerPriceMP,l=i.trailingPercent,o=e.stringGetter;return l&&!l.isZero()&&n&&this.renderRow({title:o({key:P.a.INITIAL_STOP_PRICE}),value:`${n.getNaturalValue().toFixed(r)} ${a}`,tooltipConfig:{tooltip:"initial-stop-price",top:8,left:-48}})}renderWorstPrice(){const e=this.props,t=e.currentPair,a=t.displayQuoteSymbol,r=t.tickDecimals,i=e.currentTradeData,n=i.side,l=i.price,o=i.tradeOrderType,s=i.triggerPriceMP,c=e.slippage,d=e.stopSlippage,u=e.stringGetter;let p=null;return o===le.u.MARKET&&l?p=l.getMarketPriceWithSlippage(c,n):o===le.u.STOP&&s&&(p=s.getMarketPriceWithSlippage(d,n)),p&&p.baseAmount.isFinite()&&this.renderRow({title:u({key:P.a.WORST_PRICE}),value:`${p.getNaturalValue().toFixed(r)} ${a}`,tooltipConfig:{tooltip:"slippage-worst-price",top:8,left:-48,learnMoreLink:"https://help.dydx.exchange/trading-faq/spread-price-impact-and-slippage"}})}renderTotal({feeAmount:e,isTaker:t}){const a=this.props,r=a.baseMarket,i=a.currentPair,n=i.displayQuoteSymbol,l=i.tickDecimals,o=i.isInversePerpetual,s=a.currentTradeData,c=s.side,d=s.price,u=s.amount,p=s.tradeOrderType,m=s.limitPrice,b=s.triggerPriceMP,g=a.quoteMarket,O=a.selectedTradeType,y=a.stringGetter;let T,k,E;return O===le.v.CROSS&&u&&(p===le.u.MARKET&&d?k=d.baseAmount:p===le.u.LIMIT&&m?k=m.baseAmount:p===le.u.STOP&&b&&(k=b.baseAmount),k&&(T=o?u.div(k):u.times(k))),T&&(E=o?new se.a(T,r):new se.a(c===z.f.BUY?T.plus(e?e.baseAmount:0):T.minus(e?e.baseAmount:0),g)),E&&this.renderRow({title:y({key:P.a.TOTAL}),value:`${p!==le.u.LIMIT||t?"\u2248 ":""}${E.getNaturalValue().toFixed(Math.max(l,Y.f))} ${o?E.market.symbol:n}`})}renderLiquidationPrice(){const e=this.props,t=e.currentPair,a=t.baseSymbol,r=t.displayQuoteSymbol,i=t.tickDecimals,n=e.currentTradeData.side,l=e.liquidationPrice,o=e.stringGetter;return l&&l.baseAmount.isFinite()&&this.renderRow({title:o({key:P.a.LIQUIDATION_PRICE}),value:`${l.getNaturalValue().toFixed(i)} ${r}`,tooltipConfig:{tooltip:n===z.f.BUY?"liquidation-price-long":"liquidation-price-short",top:8,left:-48,stringParams:{SYMBOL:a}}})}renderPriceImpact(){const e=this.props,t=e.priceImpact,a=e.stringGetter;return t&&this.renderRow({title:a({key:P.a.PRICE_IMPACT}),value:d.a.createElement("div",{className:O()({[be.a.red]:t.abs().gt(le.r)})},t.abs().times(100).toFixed(Y.k),"%"),tooltipConfig:{tooltip:"price-impact",top:8,left:-48}})}renderInterest(){const e=this.props,t=e.baseMarket,a=e.quoteMarket,r=e.selectedTradeType,i=e.currentTradeData,n=i.side,l=i.amount,o=i.price,s=i.marginDeposit,c=e.stringGetter,d=Object(de.a)({tradeType:r,price:o,side:n,amount:l,marginDepositMV:s}),u=d.debtWei,p=d.collateralWei;let m,b;n===z.f.SELL?(m=t,b=a):n===z.f.BUY&&(m=a,b=t);const g=Object(de.d)({borrowMarket:m,supplyMarket:b,debtWei:u,collateralWei:p});return r===le.v.ISOLATED&&g&&!g.isZero()&&this.renderRow({title:c({key:P.a.INTEREST_RATE_APR}),value:`${g.lt(0)?"+":""}${g.negated().times(100).toFixed(Y.k)}%`,tooltipConfig:{tooltip:"interest-rate",top:-148,left:-48,stringParams:{SUPPLY_SYMBOL:b.symbol,BORROW_SYMBOL:m.symbol}}})}renderFeesFields({feeAmount:e,feePercentage:t,isTaker:a,isSmallOrder:r}){const i=this.props,n=i.allPairOrderData,l=i.currentPair,o=l.orderMarket,s=l.displayQuoteSymbol,u=l.tickDecimals,p=l.type,m=l.isInversePerpetual,b=i.stringGetter,g=i.walletData,y=p===v.d.PERPETUAL;let T,k,E,h="";t&&(y&&!a?(T=b({key:P.a.MAKER}),h="fee-maker-rebate",k=-96):r?(T=b({key:P.a.SMALL_ORDER}),h="fee-small-order",k=-148,E={ETH_THRESHOLD:ge({allPairOrderData:n,orderMarket:"WETH-DAI"}),DAI_THRESHOLD:ge({allPairOrderData:n,orderMarket:"DAI-USDC"}),USD_THRESHOLD:ge({allPairOrderData:n,orderMarket:"WETH-PUSD",isPerpetual:!0}),BTC_THRESHOLD:ge({allPairOrderData:n,orderMarket:"PBTC-USDC",isPerpetual:!0})}):(T=b(a?{key:P.a.TAKER}:{key:P.a.MAKER}),h=a?"fee-taker":"fee-maker",k=a?-96:-84));const f=Y.m,S=Math.max(u,f),R=g[oe.e.HAS_SET_REFERRER];return d.a.createElement(c.Fragment,null,t&&this.renderRow({title:d.a.createElement(c.Fragment,null,b({key:P.a.FEE})," ",d.a.createElement("div",{className:be.a.badge},T),"WETH-PUSD"!==o&&R&&a&&d.a.createElement("div",{className:O()(be.a.badge,be.a.badgeGradient)},"10% OFF"),"PLINK-USDC"===o&&a&&d.a.createElement("div",{className:O()(be.a.badge,be.a.badgeGradient)},"50% OFF")),value:t.isZero()?b({key:P.a.FREE}):d.a.createElement("div",{className:O()({[be.a.red]:t.gte(le.h)})},t.times(100).toFixed(S),"%"),tooltipConfig:{tooltip:h,top:k,left:-48,stringParams:E}}),e&&this.renderRow({title:b({key:P.a.FEE_AMOUNT}),value:`\u2248 ${e.getNaturalValue().toFixed(S)} ${m?e.market.symbol:s}`}))}renderExpiration(){const e=this.props,t=e.canBypass28DayRequirement,a=e.selectedTradeType,r=e.stringGetter;let i;if(a===le.v.ISOLATED){const e=re.DateTime.local().plus({days:z.b}),a=Object(ue.c)({expiration:e,stringGetter:r}),n=a.timeString,l=a.unitString;i=t?r({key:P.a.NONE}):`${n} ${l}`}return i&&this.renderRow({title:r({key:P.a.EXPIRY}),value:i,tooltipConfig:{tooltip:"expiration",top:-108,left:-48}})}render(){const e=this.props,t=e.allOrderbookOrders,a=e.allPairOrderData,r=e.baseMarket,i=e.currentPair,n=e.currentTradeData,l=e.isLeverageValid,o=e.quoteMarket,s=e.selectedTradeType,c=e.tradeAmount,u=e.walletData,p=e.walletAddress;if(!l)return d.a.createElement("div",{className:be.a.tradeReceipt},this.renderExpiration());const m=Object(pe.a)({allOrderbookOrders:t,allPairOrderData:a,baseMarket:r,currentPair:i,currentTradeData:n,quoteMarket:o,selectedTradeType:s,tradeAmount:c,walletData:u,walletAddress:p}),b=m.feeAmount,g=m.feePercentage,O=m.isTaker,y=m.isSmallOrder;return d.a.createElement("div",{className:be.a.tradeReceipt},this.renderMarginDeposit(),this.renderTradeAmount(),this.renderExpectedPrice(),this.renderIndexPrice(),this.renderInitialStopPrice(),this.renderWorstPrice(),this.renderLiquidationPrice(),this.renderPriceImpact(),this.renderInterest(),this.renderFeesFields({feeAmount:b,feePercentage:g,isTaker:O,isSmallOrder:y}),this.renderTotal({feeAmount:b,isTaker:O}),this.renderExpiration())}}Oe.propTypes={allOrderbookOrders:p.a.object.isRequired,allPairOrderData:p.a.object.isRequired,baseMarket:p.a.object.isRequired,canBypass28DayRequirement:p.a.bool.isRequired,currentPair:p.a.object.isRequired,currentTradeData:p.a.object.isRequired,isLeverageValid:p.a.bool.isRequired,liquidationPrice:p.a.object,indexPriceNatural:p.a.object,priceImpact:p.a.object,quoteMarket:p.a.object.isRequired,selectedTradeType:p.a.string.isRequired,slippage:p.a.object.isRequired,stopSlippage:p.a.object.isRequired,stringGetter:p.a.func.isRequired,tradeAmount:p.a.object,walletData:p.a.object,walletAddress:p.a.string};var ye=Object(k.k)(Object(m.c)(e=>({allOrderbookOrders:Object(F.d)(e),allPairOrderData:Object(f.c)(e),baseMarket:Object(f.d)(e),canBypass28DayRequirement:Object(h.a)(e),currentPair:Object(f.e)(e),currentTradeData:Object(W.b)(e),indexPriceNatural:Object(U.d)(e),quoteMarket:Object(f.h)(e),selectedTradeType:Object(W.f)(e),walletData:Object(ie.b)(e),walletAddress:Object(ne.m)(e)}))(Oe)),Te=a(2153),ke=a(2143),Ee=a(2135),he=a(2139),fe=a.n(he);a(2168);function _slicedToArray(e,t){return function _arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var a=[],r=!0,i=!1,n=void 0;try{for(var l,o=e[Symbol.iterator]();!(r=(l=o.next()).done)&&(a.push(l.value),!t||a.length!==t);r=!0);}catch(s){i=!0,n=s}finally{try{r||null==o.return||o.return()}finally{if(i)throw n}}return a}(e,t)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}const Pe=({label:e,badge:t,children:a,largeText:r,onClick:i})=>{const n=_slicedToArray(Object(c.useState)(!1),2),l=n[0],o=n[1];return d.a.createElement("div",{className:"component-expandable-menu"},d.a.createElement("div",{role:"button",tabIndex:0,className:O()("label",{label__expanded:l,"label__large-text":r}),onClick:()=>{i&&i(),o(!l)}},e,d.a.createElement("div",{className:"right-container"},t&&d.a.createElement("div",{className:O()("badge",{badge__activated:t.isActive})},t.label),d.a.createElement(E.m,null))),d.a.createElement(fe.a,{isOpened:l},d.a.createElement("div",{className:"menu-content"},a)))};Pe.propTypes={badge:p.a.shape({label:p.a.string.isRequired,isActive:p.a.bool}),children:p.a.oneOfType([p.a.arrayOf(p.a.node),p.a.node]).isRequired,label:p.a.string.isRequired,largeText:p.a.bool,onClick:p.a.func};var ve=Pe,Se=a(55),Re=a.n(Se),Ie=a(97),Me=a.n(Ie),Ae=a(39),_e=a.n(Ae),Ne=a(2169),De=a.n(Ne);const Le=({className:e,tabConfig:t,selectedTabKey:a,onClick:r})=>d.a.createElement("div",{className:O()(De.a.slidingTabs,{[De.a.twoTabs]:2===_e()(t),[De.a.threeTabs]:3===_e()(t)},De.a[`selectedIndex--${Me()(t,({key:e})=>e===a)}`],e)},Re()(t,({key:e,label:t})=>d.a.createElement("div",{key:e,role:"button",tabIndex:0,className:O()(De.a.tab,{[De.a.selected]:a===e}),onClick:()=>r(e)},t)));Le.propTypes={className:p.a.string,tabConfig:p.a.arrayOf(p.a.shape({key:p.a.string.isRequired,label:p.a.string.isRequired})).isRequired,selectedTabKey:p.a.string.isRequired,onClick:p.a.func.isRequired};var je=Le,Ce=a(190),xe=a(2170),we=a.n(xe);const qe=({buttonConfig:e,largeText:t,maxSlippage:a,onChangeInput:r,onClickButton:i,slippage:n,slippageInput:l,stringGetter:o,tooltip:s="max-slippage"})=>d.a.createElement(w.c,{grey:t,label:d.a.createElement(x.a,{top:8,left:-48,tooltip:s},o({key:P.a.MAXIMUM_SLIPPAGE})),size:t?w.a.MEDIUM:w.a.SMALL},d.a.createElement("div",{className:we.a.leverageGrid},Re()(e,({label:e,value:t})=>d.a.createElement(Ce.g,{key:t,type:Ce.a.SECONDARY,selected:""===l&&n.eq(t),onClick:()=>i(t)},e)),d.a.createElement(Ce.h,{type:Ce.a.SECONDARY,onChange:e=>{const t=e.slice(0,-1);r(t)},placeholder:o({key:P.a.CUSTOM_INPUT}),selected:""!==l,max:a,value:l,suffix:"%"})));qe.propTypes={buttonConfig:p.a.arrayOf(p.a.shape({label:p.a.string,value:p.a.number})).isRequired,largeText:p.a.bool,maxSlippage:p.a.number,onChangeInput:p.a.func.isRequired,onClickButton:p.a.func.isRequired,slippage:p.a.object,slippageInput:p.a.string,stringGetter:p.a.func.isRequired,tooltip:p.a.string};var Be=Object(k.k)(qe),Ge=a(618),Ue=a(79);function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function _objectWithoutProperties(e,t){if(null==e)return{};var a,r,i=function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var a,r,i={},n=Object.keys(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var We=d.a.createElement("rect",{width:16,height:16,rx:4,fill:"#4280F9"}),Fe=d.a.createElement("path",{d:"M8 13C10.7614 13 13 10.7614 13 8C13 5.23858 10.7614 3 8 3C5.23858 3 3 5.23858 3 8C3 10.7614 5.23858 13 8 13Z",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round"}),Ve=d.a.createElement("path",{d:"M8 5V8L10 9",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round"}),Ye=function SvgGoodTil(e){var t=e.svgRef,a=_objectWithoutProperties(e,["svgRef"]);return d.a.createElement("svg",_extends({width:16,height:16,viewBox:"0 0 16 16",fill:"none",ref:t},a),We,Fe,Ve)},ze=d.a.forwardRef(function(e,t){return d.a.createElement(Ye,_extends({svgRef:t},e))});a.p;function fill_or_kill_extends(){return(fill_or_kill_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function fill_or_kill_objectWithoutProperties(e,t){if(null==e)return{};var a,r,i=function fill_or_kill_objectWithoutPropertiesLoose(e,t){if(null==e)return{};var a,r,i={},n=Object.keys(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var He=d.a.createElement("rect",{width:16,height:16,rx:4,fill:"#FF5757"}),Ke=d.a.createElement("path",{d:"M4 9H7V12",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round"}),Ze=d.a.createElement("path",{d:"M12 7H9V4",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round"}),Qe=d.a.createElement("path",{d:"M9 7L12.5 3.5",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round"}),Xe=d.a.createElement("path",{d:"M3.5 12.5L7 9",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round"}),$e=function SvgFillOrKill(e){var t=e.svgRef,a=fill_or_kill_objectWithoutProperties(e,["svgRef"]);return d.a.createElement("svg",fill_or_kill_extends({width:16,height:16,viewBox:"0 0 16 16",fill:"none",ref:t},a),He,Ke,Ze,Qe,Xe)},Je=d.a.forwardRef(function(e,t){return d.a.createElement($e,fill_or_kill_extends({svgRef:t},e))}),et=(a.p,a(83)),tt=a(49),at=a(45),rt=a(102),it=a(249),nt=a(21),lt=a(38),ot=a(279),st=a(32);const ct=window.crypto||window.msCrypto;var dt=a(85),ut=a(103),pt=a(25),mt=a(170);a(2171);function trade_box_objectWithoutProperties(e,t){if(null==e)return{};var a,r,i=function trade_box_objectWithoutPropertiesLoose(e,t){if(null==e)return{};var a,r,i={},n=Object.keys(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function asyncGeneratorStep(e,t,a,r,i,n,l){try{var o=e[n](l),s=o.value}catch(c){return void a(c)}o.done?t(s):Promise.resolve(s).then(r,i)}function _asyncToGenerator(e){return function(){var t=this,a=arguments;return new Promise(function(r,i){var n=e.apply(t,a);function _next(e){asyncGeneratorStep(n,r,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(n,r,i,_next,_throw,"throw",e)}_next(void 0)})}}function ownKeys(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(a,!0).forEach(function(t){_defineProperty(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ownKeys(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const bt=[{labelKey:P.a.DAYS_ABBREVIATED,value:nt.g.DAYS},{labelKey:P.a.HOURS_ABBREVIATED,value:nt.g.HOURS},{labelKey:P.a.MINS_ABBREVIATED,value:nt.g.MINUTES}],gt={leverageInput:"",leverage:new T.a(2),slippageInput:"",slippage:le.d,stopSlippageInput:"",stopSlippage:le.e,error:null,loading:!1,didSetExpirationApproval:!1},Ot=_objectSpread({},gt,{goodTilDateInput:null,isTrailingStopOrder:!1});class yt extends c.Component{constructor(e){var t;super(e),t=this,this.componentDidUpdate=(e=>{const t=this.props,a=t.selectedTradeType,r=t.currentPair,i=t.currentTradeData,n=i.price,l=i.side,o=i.amount,c=t.setTradeData,d=this.state.leverage,u=e.currentPair,p=e.selectedTradeType;if(r.key!==u.key||r.type!==u.type)this.resetTradeBox();else if(a!==p)this.resetTradeBox({resetTradeData:!1});else{const e=this.getMarketPrice(l,o,d);s()(e,"baseAmount","").toString()!==s()(n,"baseAmount","").toString()&&c({price:this.getMarketPrice(l,o,d)})}}),this.resetTradeBox=(({resetTradeData:e=!0,resetIsTrailing:t=!0}={})=>{const a=this.props.setTradeData;e&&a(le.c);const r=_objectSpread({},gt);t&&(r.isTrailingStopOrder=!1),this.setState(r)}),this.getMarginAccountBalanceBN=(e=>{const t=this.props.marginAccount;if(!e)return null;const a=Object(rt.b)({account:t,market:e});return a?Object(K.a)(a.wei):null}),this.onClickCta=_asyncToGenerator(function*(){const e=t.props,a=e.allPairOrderData,r=e.baseMarket,i=e.canBypass28DayRequirement,n=e.currentPair,l=e.currentTradeData,o=l.amount,s=l.price,c=l.side,u=l.marginDeposit,p=l.tradeOrderType,m=l.triggerPriceMP,b=l.trailingPercent,g=e.legacySigning,O=e.marginAccount,y=e.openModal,k=e.placeCrossOrder,E=e.placeMarketIsolatedOrder,h=e.quoteMarket,f=e.selectedTradeType,S=e.stringGetter,R=e.walletAddress,I=e.walletType,M=n.type,A=t.state,_=A.leverage,N=A.slippage,D=A.isTrailingStopOrder;t.setState({loading:!0});const L=t.getIsolatedTradeAmount(o,_,c),j=function(){var e=_asyncToGenerator(function*(){try{if(f===le.v.CROSS){const e=t.getSoloLimitOrderData(),r=e.order,i=e.fillOrKill,l=e.postOnly,o=e.setExpirationOnFill,s=p===le.u.STOP;yield k({allPairOrderData:a,pair:n,walletType:I,legacySigning:g,order:r,fillOrKill:i,postOnly:l,setExpirationOnFill:o,isStopOrder:s,isTrailingStopOrder:s&&D,triggerPriceMP:(s||D)&&m,trailingPercent:s&&D&&(c===z.f.BUY?b:b.negated())})}else{const e=function getRandomHex(e){const t=ct.getRandomValues(new Uint8Array(e));let a="0x";for(let r=0;r<=t.length-1;r+=1){let e=t[r].toString(16);1===e.length&&(e=`0${e}`),a+=e}return a}(32),l=new T.a(e),d=s.getMarketPriceWithSlippage(N,c),p=Object(ut.a)({allPairOrderData:a,pair:n,baseMarket:r,quoteMarket:h,amount:L,side:c,priceMP:d,walletAddress:R,accountNumber:l,tradeOrderType:le.u.MARKET,isIsolatedOrder:!0}).order;yield E({order:p,marginDeposit:u,positionSize:o,leverage:_,liquidationPrice:t.getLiquidationPrice(),openPriceMP:d,side:c,baseMarket:r,quoteMarket:h,pair:n,accountNumberBN:l,walletAddress:R,walletType:I,legacySigning:g,setExpiration:!i})}t.resetTradeBox({resetIsTrailing:!1})}catch(e){let a;Object(mt.d)(e)?M===v.d.SPOT?(a=S({key:P.a.SPOT_LOW_COLL_TRY_POST_ONLY}),Object(dt.b)("trade-box","spot-collateralization-threshold-error")):(a=S({key:P.a.LOW_COLL_ORDER_TRY_AGAIN}),Object(dt.b)("trade-box","collateralization-threshold-error")):Object(mt.a)(e)?(a=S({key:P.a.PENDING_FILLS_TRY_AGAIN}),Object(dt.b)("trade-box","pending-fills-error")):Object(mt.f)(e)&&(a=S({key:P.a.SPOT_BALANCE_BELOW_ZERO}),Object(dt.b)("trade-box","spot-balance-below-zero-error"));const r=Object(mt.j)({error:e,walletAddress:R,walletType:I,location:"trade-box:place-order",notifyBugsnag:!a,stringGetter:S}).message;t.setState({loading:!1,error:a||r})}});return function executeOrder(){return e.apply(this,arguments)}}(),C=Object(K.a)(t.getPriceImpact()),x=C.abs().gt(le.r),w=t.getMarginAccountBalanceBN(r),q=t.getMarginAccountBalanceBN(h);let B=!1;f===le.v.ISOLATED&&(B=c===z.f.BUY?w.gte(0)&&w.minus(u.baseAmount).lt(0):q.gte(0)&&q.minus(u.baseAmount).lt(0));const G=Object(rt.c)({account:O,market:r}),U=Object(rt.c)({account:O,market:h});let W;f===le.v.ISOLATED&&(c===z.f.BUY&&w.lt(0)&&(G||i||(W=!0)),c===z.f.SELL&&q.lt(0)&&(U||i||(W=!0)));const F={onClickCta:j,onClickCancel:()=>t.setState({loading:!1}),onClickOutside:()=>t.setState({loading:!1})};if(B){let e="";i||(e=S({key:P.a.EXPIRATION_WARNING})),yield y({type:lt.a.WARNING,props:_objectSpread({title:S({key:P.a.NEGATIVE_BALANCE_WARNING_TITLE}),body:d.a.createElement("span",null,S({key:P.a.NEGATIVE_BALANCE_WARNING_BODY,params:{SYMBOL:c===z.f.BUY?r.symbol:h.symbol}})," ",e," ",S({key:P.a.WARNING_CONFIRM_TRADE})),ctaLabel:S({key:P.a.YES_CONTINUE})},F)})}else if(W){const e=c===z.f.BUY?r.symbol:h.symbol;yield y({type:lt.a.WARNING,props:_objectSpread({title:S({key:P.a.NEW_EXPIRY_WARNING_TITLE}),body:d.a.createElement("span",null,S({key:P.a.NEW_EXPIRY_WARNING_BODY,params:{SYMBOL:e}})," ",S({key:P.a.WARNING_CONFIRM_TRADE})),ctaLabel:S({key:P.a.YES_CONTINUE})},F)})}else x?yield y({type:lt.a.WARNING,props:_objectSpread({title:S({key:P.a.HIGH_PRICE_IMPACT_WARNING_TITLE}),body:d.a.createElement("span",null,S({key:P.a.HIGH_PRICE_IMPACT_WARNING_BODY,params:{PRICE_IMPACT:`${C.times(100).toFixed(2)}%`}})," ",S({key:P.a.WARNING_CONFIRM_TRADE})),ctaLabel:S({key:P.a.YES_CONTINUE})},F)}):yield j();t.setState({loading:!1})}),this.setDydexExpirationApproval=_asyncToGenerator(function*(){const e=t.props,a=e.setExpiryApproval,r=e.stringGetter,i=e.walletAddress,n=e.walletType;t.setState({loading:!0,didSetExpirationApproval:!0});try{yield a({walletAddress:i})}catch(l){const e=Object(mt.j)({error:l,walletAddress:i,walletType:n,location:"trade-box:set-approval",stringGetter:r}).message;t.setState({loading:!1,error:e,didSetExpirationApproval:!1})}t.setState({loading:!1})}),this.getSoloLimitOrderData=(()=>{const e=this.props,t=e.allPairOrderData,a=e.baseMarket,r=e.canBypass28DayRequirement,i=e.currentPair,n=e.currentTradeData,l=n.amount,o=n.price,s=n.side,c=n.tradeOrderType,d=n.limitPrice,u=n.triggerPriceMP,p=n.postOnlyChecked,m=n.timeInForceOption,b=n.trailingPercent,g=e.selectedTradeType,O=e.quoteMarket,y=e.spotAccount,k=e.walletAddress,E=this.state,h=E.leverage,f=E.slippage,P=E.stopSlippage,S=E.goodTilDateInput,R=E.goodTilDateTimescale,I=E.isTrailingStopOrder;if(!l||l.lt(0)||c===le.u.LIMIT&&!d||c===le.u.MARKET&&!o||c===le.u.STOP&&(I?!b||b.isZero():!u))return{};const M=i.type;let A;if(c===le.u.LIMIT)A=d;else if(c===le.u.MARKET){const e=o.getMarketPriceWithSlippage(f,s);if(M===v.d.SPOT&&s===z.f.BUY){const t=st.a.canonicalOrders.getFeeForOrder(Object(K.a)(a.id),l),r=Object(K.a)(Object(rt.b)({account:y,market:O}).wei).div(l.times(t.plus(1)));A=new ce.a(T.a.min(r,e.baseAmount),a,O)}else A=e}else c===le.u.STOP&&(A=u.getMarketPriceWithSlippage(P,s));const _=g===le.v.ISOLATED,N=Object(ut.a)({allPairOrderData:t,pair:i,baseMarket:a,quoteMarket:O,amount:_?this.getIsolatedTradeAmount(l,h,s):l,side:s,priceMP:A,triggerPriceMP:u,walletAddress:k,tradeOrderType:c,goodTilDate:new T.a(Object(ut.d)(S,R.value).toSeconds()).integerValue(T.a.ROUND_CEIL),timeInForceOption:m,postOnly:p,decreaseOnly:!1,isTrailingStopOrder:I,isIsolatedOrder:_});return{order:N.order,fillOrKill:N.fillOrKill,postOnly:N.postOnly,setExpirationOnFill:!r}}),this.onChangeCustomLeverage=(e=>{const t=this.props.currentTradeData.side,a=e.slice(0,-1);this.setState({leverageInput:a}),Object(dt.b)("trade-box","change-custom-leverage-button",{leverage:a}),(t===z.f.SELL&&a>0&&a<=4||t===z.f.BUY&&a>1&&a<=5)&&this.updateOrder({leverage:new T.a(e.slice(0,-1))})}),this.onUpdateLeverage=(e=>{this.setState({leverageInput:""}),Object(dt.b)("trade-box","click-leverage-button",{leverage:e}),this.updateOrder({leverage:new T.a(e)})}),this.onUpdateAmountInput=((e,t)=>{const a=this.state.leverage;this.updateOrder({newAmount:e,newAmountDisplayValue:t,leverage:a})}),this.onUpdateLimitPriceInput=((e,t)=>{const a=this.props,r=a.allPairOrderData,i=a.currentPair.orderMarket,n=a.setTradeData,l=a.baseMarket,o=a.quoteMarket,s=a.currentTradeData.tradeOrderType,c=(r[i]||{}).minimumTickSize,d=z.a.ONE.shiftedBy(l.currency.decimals);let u=s;t&&(u=le.u.LIMIT),n({tradeOrderType:u,limitPrice:t?new ce.a(e.div(d),l,o).getMarketPriceRoundedToTickSize(c):null}),this.setState({error:null})}),this.onUpdateStopPriceInput=((e,t)=>{const a=this.props,r=a.allPairOrderData,i=a.currentPair.orderMarket,n=a.setTradeData,l=a.baseMarket,o=a.quoteMarket,s=(r[i]||{}).minimumTickSize,c=z.a.ONE.shiftedBy(l.currency.decimals);n({triggerPriceMP:t?new ce.a(e.div(c),l,o).getMarketPriceRoundedToTickSize(s):null}),this.setState({error:null})}),this.onUpdateTrailingPercentInput=(e=>{const t=this.props,a=t.allIndexPrices,r=t.allMarkets,i=t.baseMarket,n=t.currentPair,l=t.currentTradeData.side,o=t.quoteMarket,s=t.setTradeData;let c=null;if(e&&!e.isZero()){const t=Object(U.a)({pair:n,allIndexPrices:a,allMarkets:r});c=ce.a.fromNaturalValue(Object(K.a)(t).times(l===z.f.BUY?z.a.ONE.plus(e.shiftedBy(-2)):z.a.ONE.minus(e.shiftedBy(-2))),i,o)}s({trailingPercent:e,triggerPriceMP:c}),this.setState({error:null})}),this.onUpdateGoodTilDate=((e,t)=>{let a=parseInt(e,10);a>nt.e&&(a=nt.e),this.setState({error:null,goodTilDateInput:a,goodTilDateTimescale:t})}),this.onClickMax=(()=>{const e=this.props,t=e.allMarkets,a=e.allOrderbookOrders,r=e.currentPair,i=e.baseMarket,n=e.quoteMarket,l=e.currentTradeData.side,o=e.selectedTradeType,s=this.state.leverage,c=this.getMarginAccountBalanceBN(i),d=this.getMarginAccountBalanceBN(n);if(i&&n&&c&&d&&o===le.v.ISOLATED){const e=Object(de.c)({allMarkets:t,allOrderbookOrders:a,currentPair:r,baseMarket:i,quoteMarket:n,side:l,leverage:s,baseMarketBalanceBN:c,quoteMarketBalanceBN:d,collateralization:this.getCollateralization(s,l)});if(e){const t=e.amount,a=e.amountNatural;this.updateOrder({newAmount:t,newAmountDisplayValue:a,leverage:s})}}}),this.onClickBuy=(()=>{const e=this.props.selectedTradeType,t=this.state.leverage;let a=t;e!==le.v.ISOLATED||!t.lte(1)&&this.getIsLeverageValid()||(a=new T.a(2),this.setState({leverageInput:""})),Object(dt.b)("trade-box","click-long"),this.updateOrder({newSide:z.f.BUY,leverage:a})}),this.onClickSell=(()=>{const e=this.state.leverage;let t=e;!e.gte(3)&&this.getIsLeverageValid()||(t=new T.a(3),this.setState({leverageInput:""})),Object(dt.b)("trade-box","click-short"),this.updateOrder({newSide:z.f.SELL,leverage:t})}),this.updateOrder=(({newAmount:e,newAmountDisplayValue:t,newSide:a,leverage:r})=>{const i=this.props,n=i.baseMarket,o=i.currentTradeData,s=o.amount,c=o.side,d=i.quoteMarket,u=i.selectedTradeType,p=i.setTradeData,m=this.state.amountDisplayValue,b=e||s,g=a||c,O=this.getMarketPrice(g,b,r);if(u===le.v.CROSS)return p({amount:b,amountDisplayValue:l()(t)?m:t,side:g,price:O,selectedPerpetualLeverage:null}),void this.setState({error:null,leverage:r});const y=g===z.f.SELL?d:n;let T=null;O&&b.gt(z.a.ZERO)&&(T=Object(de.b)({positionCollateralization:this.getCollateralization(r,g),tradeAmount:this.getIsolatedTradeAmount(b,r,g),orderSide:g,orderAmount:b,price:O,marginDepositMarket:y,quoteMarket:d})),p({amount:b,amountDisplayValue:l()(t)?m:t,side:g,price:O,marginDeposit:T,marginDepositMarket:y}),this.setState({error:null,leverage:r})}),this.getIsLeverageValid=(()=>{const e=this.state,t=e.leverageInput,a=e.leverage;return!(""!==t&&!new T.a(t).eq(a))}),this.renderSubmitButton=(e=>{const t=this.props,a=t.areDydexOrdersEnabled,r=t.canBypass28DayRequirement,n=t.currentPair.type,l=t.currentTradeData,o=l.amount,s=l.side,c=l.tradeOrderType,u=l.limitPrice,p=l.triggerPriceMP,m=l.trailingPercent,b=t.isPairOrderDataLoaded,g=t.isUserInUsa,O=t.isWalletReady,y=t.selectedTradeType,T=t.stringGetter,k=t.walletAddress,E=this.state,h=E.loading,f=E.didSetExpirationApproval,S=E.isTrailingStopOrder,R=n===v.d.PERPETUAL,I=n===v.d.MARGIN;let M,A,_=!1;I&&O&&(!1!==a||r||(_=!0));const N=R&&g&&!Object(H.d)(k);N?(M=i.a,A=T({key:P.a.UNAVAILABLE})):_?(M=this.setDydexExpirationApproval,A=T({key:P.a.ENABLE_DYDX_ORDERS})):(M=this.onClickCta,y===le.v.ISOLATED?A=s===z.f.BUY?T({key:P.a.OPEN_LONG_POSITION}):T({key:P.a.OPEN_SHORT_POSITION}):c===le.u.MARKET?A=T({key:P.a.PLACE_MARKET_ORDER}):c===le.u.LIMIT?A=T({key:P.a.PLACE_LIMIT_ORDER}):c===le.u.STOP&&(A=T({key:P.a.PLACE_STOP_ORDER})));const D=g&&I&&O&&null===a,L=f&&!a,j=!!e||!o||o.eq(z.a.ZERO)||c===le.u.LIMIT&&(!u||u.baseAmount.isZero())||c===le.u.STOP&&(S?!m||m.isZero():!p)||!this.getIsLeverageValid(),C=!O||!_&&j||R&&N;return d.a.createElement(Ce.c,{className:"cta-button",onClick:M,disabled:!ot.a.enablealways&&(C||D||!b),green:s===z.f.BUY,red:s===z.f.SELL,loading:h||D||L||!b},A)}),this.getError=(()=>{const e=this.props,t=e.allIndexPrices,a=e.allMarkets,r=e.allOrderbookOrders,i=e.allOrders,n=e.allPairOrderData,l=e.baseMarket,o=e.currentPair,s=e.currentTradeData,c=e.marginAccount,d=e.perpetualBalances,u=e.perpetualMarkets,p=e.quoteMarket,m=e.selectedTradeType,b=e.spotAccount,g=e.stringGetter,O=this.state,y=O.leverage,T=O.goodTilDateInput,k=O.goodTilDateTimescale,E=s.side,h=s.amount;return Object(mt.i)({account:o.type===v.d.SPOT?b:c,allIndexPrices:t,allMarkets:a,allOrders:i,allPairOrderData:n,baseMarket:l,currentPair:o,currentTradeData:s,goodTilDateInput:T,goodTilDateTimescale:k,oraclePriceNatural:Object(G.a)({allMarkets:a,perpetualMarkets:u,pair:o}),perpetualBalances:d,perpetualMarkets:u,quoteMarket:p,selectedTradeType:m,soloLimitOrderData:this.getSoloLimitOrderData(),stringGetter:g,tradeAmount:m===le.v.CROSS?h:this.getIsolatedTradeAmount(h,y,E),worstPrice:Object(F.b)({allOrderbookOrders:r,allMarkets:a,pair:o,side:E,amount:h})})});const a=e.stringGetter;this.state=_objectSpread({},Ot,{goodTilDateTimescale:{label:a({key:bt[0].labelKey}),value:bt[0].value}})}getIsolatedTradeAmount(e,t,a){return a===z.f.SELL?e:e.times(z.a.ONE.minus(z.a.ONE.div(t)))}getCollateralization(e,t){if(t===z.f.SELL){if(e.lte(z.a.ZERO))throw new Error(`Leverage <= 0 : ${e.toFixed()}`);return e.plus(1).div(e)}if(e.lte(1))throw new Error(`Leverage <= 1 : ${e.toFixed()}`);return e.div(e.minus(1))}getMarketPrice(e,t,a){const r=this.props,i=r.allOrderbookOrders,n=r.allMarkets,l=r.currentPair;let o=t;return r.selectedTradeType===le.v.ISOLATED&&(o=this.getIsolatedTradeAmount(t,a,e)),Object(F.a)({allOrderbookOrders:i,allMarkets:n,pair:l,side:e,amount:o})}getPriceImpact(){const e=this.props,t=e.currentPair,a=e.allOrderbookOrders,r=e.currentTradeData,i=r.price,n=r.side,l=r.amount,o=r.tradeOrderType,s=Object(F.c)({allOrderbookOrders:a,pair:t,side:n});let c;return o===le.u.MARKET&&s&&l.gt(z.a.ZERO)&&i&&(c=new T.a(i.baseAmount).minus(s).div(s)),c}getLiquidationPrice(){const e=this.props,t=e.baseMarket,a=e.quoteMarket,r=e.selectedTradeType,i=e.currentTradeData,n=i.price,l=i.side,o=i.amount,s=i.marginDeposit;let c;if(!n||!o.gt(z.a.ZERO))return c;const d=Object(de.a)({tradeType:r,price:n,side:l,amount:o,marginDepositMV:s}),u=d.debtWei,p=d.collateralWei;if(r===le.v.ISOLATED){let e;l===z.f.BUY?e=u.times(le.k).div(p).abs():l===z.f.SELL&&(e=p.div(le.k).div(u).abs()),c=new ce.a(e,t,a)}return c}renderInputs(){const e=this.props,t=e.currentPair,a=t.type,r=t.displayQuoteSymbol,i=t.tickDecimals,n=t.isInversePerpetual,l=e.baseMarket,o=e.quoteMarket,s=e.currentTradeData,u=s.amount,p=s.amountDisplayValue,m=s.side,b=s.tradeOrderType,g=s.limitPrice,O=s.triggerPriceMP,y=s.trailingPercent,k=e.selectedTradeType,E=e.setTradeData,h=e.stringGetter,f=this.state,S=f.leverage,R=f.isTrailingStopOrder,I=this.getMarketPrice(m,u.gt(0)?u:new T.a(.1),S),M=I?`~${I.getNaturalValue().toFixed(i)}`:"-",A=a===v.d.PERPETUAL,_=k===le.v.ISOLATED,N=k===le.v.CROSS,D=b===le.u.MARKET,L=b===le.u.LIMIT,j=b===le.u.STOP,C=[{key:le.u.MARKET,label:h({key:P.a.ORDER_TYPES_MARKET})},{key:le.u.LIMIT,label:h({key:P.a.ORDER_TYPES_LIMIT})},{key:le.u.STOP,label:h({key:P.a.ORDER_TYPES_STOP})}];let q;q=_?"position-size":m===z.f.BUY?"amount-buy":"amount-sell";const B=A?L:N&&!j;return d.a.createElement(c.Fragment,null,N&&d.a.createElement(je,{className:"order-type-tabs",tabConfig:C,selectedTabKey:b,onClick:e=>{this.setState({isTrailingStopOrder:!1}),E({tradeOrderType:e,limitPrice:null,triggerPriceMP:null,trailingPercent:null})}}),j&&d.a.createElement(Te.a,{className:"toggle",leftLabel:h({key:P.a.STANDARD}),rightLabel:d.a.createElement("div",{className:"trailing-stop-toggle"},d.a.createElement("div",{className:"trailing-label"},h({key:P.a.TRAILING_STOP_ABBREVIATED}),d.a.createElement(x.a,{shortDelay:!0,className:"help-icon",top:12,left:-228,tooltip:"trailing-stop"},"?"))),onClickLeft:()=>{this.setState({isTrailingStopOrder:!1}),E({triggerPriceMP:null,trailingPercent:null})},onClickRight:()=>{this.setState({isTrailingStopOrder:!0}),E({triggerPriceMP:null,trailingPercent:null})},isToggledRight:R,grayscale:!0,compact:!0}),d.a.createElement(w.c,{label:d.a.createElement(x.a,{top:8,left:-48,tooltip:q,stringParams:{SYMBOL:l.symbol}},h(_?{key:P.a.POSITION_SIZE}:{key:P.a.AMOUNT}))},d.a.createElement(Ge.b,{autoFillZero:!0,value:p,market:n?_objectSpread({},o,{symbol:r}):l,onChange:this.onUpdateAmountInput,onClickMax:_?this.onClickMax:null})),B&&d.a.createElement(w.c,{label:h({key:P.a.PRICE})},d.a.createElement(Ge.b,{value:g&&g.getNaturalValue().toFixed(i),market:_objectSpread({},o,{symbol:r}),whitePlaceholder:b===le.u.MARKET,placeholder:b===le.u.MARKET?M:h({key:P.a.ENTER_PRICE}),onChange:this.onUpdateLimitPriceInput})),A&&D&&d.a.createElement(c.Fragment,null,d.a.createElement("div",{className:"perpetual-slider-divider"},d.a.createElement("div",{className:"perpetual-slider-divider__line"}),d.a.createElement("div",{className:"perpetual-slider-divider__text"},h({key:P.a.OR})),d.a.createElement("div",{className:"perpetual-slider-divider__line"})),d.a.createElement(ae,null)),j&&(R?d.a.createElement(w.c,{label:d.a.createElement(x.a,{top:8,left:-48,tooltip:"trailing-stop"},h({key:P.a.TRAILING_PERCENT}))},d.a.createElement(Ge.b,{suffix:"%",value:y?y.toFixed(Y.k):"",placeholder:h({key:P.a.ENTER_PERCENT}),onChange:this.onUpdateTrailingPercentInput})):d.a.createElement(w.c,{label:d.a.createElement(x.a,{top:8,left:-48,tooltip:"stop-price",stringParams:{SYMBOL:l.symbol}},h({key:P.a.STOP_PRICE}))},d.a.createElement(Ge.b,{value:O&&O.getNaturalValue().toFixed(i),market:_objectSpread({},o,{symbol:r}),placeholder:h({key:P.a.ENTER_PRICE}),onChange:this.onUpdateStopPriceInput}))),_&&this.renderLeverageGrid())}renderLeverageGrid(){const e=this.props,t=e.currentTradeData.side,a=e.stringGetter,r=this.state,i=r.leverage,n=r.leverageInput,l=""!==n;return d.a.createElement(w.c,{label:d.a.createElement(x.a,{top:6,left:-48,tooltip:"leverage"},a({key:P.a.LEVERAGE}))},d.a.createElement("div",{className:"leverage-grid"},d.a.createElement(Ce.g,{type:Ce.a.SECONDARY,disabled:t===z.f.BUY,selected:!l&&i.eq(1),onClick:()=>this.onUpdateLeverage(1)},"1x"),d.a.createElement(Ce.g,{type:Ce.a.SECONDARY,selected:!l&&i.eq(2),onClick:()=>this.onUpdateLeverage(2)},"2x"),d.a.createElement(Ce.g,{type:Ce.a.SECONDARY,selected:!l&&i.eq(3),onClick:()=>this.onUpdateLeverage(3)},"3x"),d.a.createElement(Ce.g,{type:Ce.a.SECONDARY,selected:!l&&i.eq(4),onClick:()=>this.onUpdateLeverage(4)},"4x"),d.a.createElement(Ce.g,{type:Ce.a.SECONDARY,disabled:t===z.f.SELL,selected:!l&&i.eq(5),onClick:()=>this.onUpdateLeverage(5)},"5x"),d.a.createElement(Ce.h,{type:Ce.a.SECONDARY,onChange:this.onChangeCustomLeverage,placeholder:a({key:P.a.CUSTOM_INPUT}),selected:l,max:t===z.f.SELL?4:5,value:n,suffix:"X"})))}renderSlippageGrid(){let e,t,a,r,i;this.props.currentTradeData.tradeOrderType===le.u.STOP?(e="stopSlippage",t="stopSlippageInput",a=le.e,r=le.o,i=[{value:.02,label:"2.0%"},{value:.05,label:"5.0%"}]):(e="slippage",t="slippageInput",a=le.d,r=le.l,i=[{value:.005,label:"0.5%"},{value:.01,label:"1.0%"}]);const n=this.state,l=n[e],o=n[t];return d.a.createElement(Be,{slippage:l,slippageInput:o,buttonConfig:i,onClickButton:a=>this.setState({[e]:new T.a(a),[t]:""}),onChangeInput:r=>this.setState({[e]:r?new T.a(r).div(100):a,[t]:r}),maxSlippage:r.times(100).toNumber()})}getTimeInForceConfig(){const e=this.props.stringGetter;return[{key:nt.p.GOOD_TIL,label:d.a.createElement("div",{className:"time-in-force-option"},d.a.createElement(ze,null),e({key:P.a.GOOD_TIL_DATE_ABBREVIATED}))},{key:nt.p.FILL_OR_KILL,label:d.a.createElement("div",{className:"time-in-force-option"},d.a.createElement(Je,null),e({key:P.a.FILL_OR_KILL}))}]}renderGoodTilDate(){const e=this.props.stringGetter,t=this.state,a=t.goodTilDateInput,r=t.goodTilDateTimescale;return d.a.createElement(w.c,{label:d.a.createElement(x.a,{top:8,left:-48,tooltip:"good-til-date"},e({key:P.a.GOOD_TIL_DATE}))},d.a.createElement(Ge.c,{inputValue:a,dropdownValue:r,placeholder:z.b,onChange:this.onUpdateGoodTilDate,dropdownConfig:bt.map(t=>{let a=t.labelKey;return _objectSpread({},trade_box_objectWithoutProperties(t,["labelKey"]),{label:e({key:a})})}),max:1e3}))}renderLimitOrderOptions(){const e=this.props,t=e.currentTradeData,a=t.postOnlyChecked,r=t.timeInForceOption,i=e.setTradeData,n=e.stringGetter;return d.a.createElement(c.Fragment,null,d.a.createElement(w.c,{label:d.a.createElement(x.a,{top:8,left:-48,tooltip:"time-in-force"},n({key:P.a.TIME_IN_FORCE}))},d.a.createElement(Ee.b,{compact:!0,selectedItemKey:r,onChangeSelection:e=>i({timeInForceOption:e}),menuItems:this.getTimeInForceConfig()})),r===nt.p.GOOD_TIL&&d.a.createElement(c.Fragment,null,this.renderGoodTilDate(),d.a.createElement(w.c,{label:n({key:P.a.TRADE_EXECUTION})},d.a.createElement(ke.a,{className:"post-only-checkbox",checked:a,label:d.a.createElement(c.Fragment,null,d.a.createElement("div",{className:"post-only-checkbox__label"},n({key:P.a.POST_ONLY}),d.a.createElement(x.a,{className:"post-only-checkbox__tooltip",top:8,left:-144,tooltip:"post-only"},"?"))),onClick:()=>i({postOnlyChecked:!a})}))))}renderAdvancedOptions(){const e=this.props,t=e.baseMarket,a=e.currentPair.type,r=e.currentTradeData,i=r.tradeOrderType,n=r.newBaseMarketAccountBalance,l=r.newQuoteMarketAccountBalance,o=e.quoteMarket,s=e.selectedTradeType,u=e.stringGetter,p=this.state.isTrailingStopOrder;let m;switch(i){case le.u.MARKET:m=this.renderSlippageGrid();break;case le.u.LIMIT:m=this.renderLimitOrderOptions();break;case le.u.STOP:m=d.a.createElement(c.Fragment,null,this.renderGoodTilDate(),this.renderSlippageGrid());break;default:m=d.a.createElement("div",null)}const b=this.getMarginAccountBalanceBN(t),g=this.getMarginAccountBalanceBN(o),O=a===v.d.MARGIN;let y;s===le.v.CROSS&&O&&(y={label:u({key:P.a.MARGIN}),isActive:b.lt(0)||g.lt(0)||n&&n.lt(0)||l&&l.lt(0)});const T=Object(pt.b)(pt.a.HIDE_MARGIN_TRADING_INFO)||!O;return d.a.createElement(ve,{label:u({key:P.a.ADVANCED_OPTIONS}),badge:y,onClick:()=>Object(dt.b)("trade-box","toggle-advanced-options",{selectedTradeType:s,tradeOrderType:i,isTrailingStopOrder:p})},m,s===le.v.CROSS&&!T&&d.a.createElement(w.c,{label:d.a.createElement("div",{className:"margin-trading-info"},u({key:P.a.MARGIN_TRADING}),d.a.createElement("div",{role:"button",tabIndex:0,className:"dismiss-button",onClick:()=>{Object(pt.d)(pt.a.HIDE_MARGIN_TRADING_INFO,!0)}},u({key:P.a.DISMISS})))},d.a.createElement("div",{className:"info-subsection"},u({key:P.a.MARGIN_TRADING_DESCRIPTION}))))}renderReceipt(){const e=this.props,t=e.currentTradeData,a=t.side,r=t.amount,i=e.selectedTradeType,n=this.state,l=n.leverage,o=n.slippage,s=n.stopSlippage,c=i===le.v.CROSS?r:this.getIsolatedTradeAmount(r,l,a);return d.a.createElement(ye,{priceImpact:this.getPriceImpact(),tradeAmount:c,isLeverageValid:this.getIsLeverageValid(),liquidationPrice:this.getLiquidationPrice(),slippage:o,stopSlippage:s})}render(){const e=this.props,t=e.currentPair.type,a=e.currentTradeData.side,r=e.selectedTradeType,i=e.stringGetter,n=e.walletAddress,l=this.state.error;let o=i({key:P.a.LONG}),s=i({key:P.a.SHORT});r===le.v.CROSS&&(o=i({key:P.a.BUY}),s=i({key:P.a.SELL}));const c=l||this.getError();return d.a.createElement("div",{className:O()("component-trade-box",{"component-trade-box__top-border-radius":t!==v.d.MARGIN})},d.a.createElement("div",{className:"order-section"},!Object(H.d)(n)&&d.a.createElement(M,null),d.a.createElement(Te.a,{className:"toggle",leftLabel:o,rightLabel:s,onClickLeft:this.onClickBuy,onClickRight:this.onClickSell,isToggledRight:a===z.f.SELL}),this.renderInputs(),this.renderAdvancedOptions(),this.renderReceipt(),this.renderSubmitButton(c)),d.a.createElement("div",{className:"error-section"},c?d.a.createElement(Ue.c,null,c):null))}}yt.propTypes={allIndexPrices:p.a.object.isRequired,allMarkets:p.a.array.isRequired,allOrderbookOrders:p.a.object.isRequired,allOrders:p.a.array.isRequired,allPairOrderData:p.a.object.isRequired,areDydexOrdersEnabled:p.a.bool,baseMarket:p.a.object.isRequired,canBypass28DayRequirement:p.a.bool.isRequired,currentPair:p.a.object.isRequired,currentTradeData:p.a.object.isRequired,isPairOrderDataLoaded:p.a.bool.isRequired,isUserInUsa:p.a.bool.isRequired,isWalletReady:p.a.bool.isRequired,legacySigning:p.a.bool,marginAccount:p.a.object,openModal:p.a.func.isRequired,perpetualBalances:p.a.object.isRequired,perpetualMarkets:p.a.object.isRequired,placeCrossOrder:p.a.func.isRequired,placeMarketIsolatedOrder:p.a.func.isRequired,quoteMarket:p.a.object.isRequired,selectedTradeType:p.a.string.isRequired,setExpiryApproval:p.a.func.isRequired,setTradeData:p.a.func.isRequired,spotAccount:p.a.object,stringGetter:p.a.func.isRequired,walletAddress:p.a.string,walletType:p.a.string};var Tt=Object(k.k)(Object(m.c)(e=>({allIndexPrices:Object(U.b)(e),allMarkets:Object(G.d)(e),allOrderbookOrders:Object(F.d)(e),allOrders:Object(it.k)(e),allPairOrderData:Object(f.c)(e),areDydexOrdersEnabled:Object(it.f)(e),baseMarket:Object(f.d)(e),canBypass28DayRequirement:Object(h.a)(e),currentPair:Object(f.e)(e),currentTradeData:Object(W.b)(e),isPairOrderDataLoaded:Object(f.f)(e),isUserInUsa:Object(h.c)(e),isWalletReady:Object(ne.w)(e),legacySigning:Object(ne.i)(e),marginAccount:Object(rt.r)(e),perpetualBalances:Object(B.e)(e),perpetualMarkets:Object(B.g)(e),quoteMarket:Object(f.h)(e),selectedTradeType:Object(W.f)(e),spotAccount:Object(rt.v)(e),walletAddress:Object(ne.m)(e),walletType:Object(ne.q)(e)}),e=>Object(b.b)({placeMarketIsolatedOrder:et.d,openModal:at.c,setExpiryApproval:tt.d,setTradeData:q.e,placeCrossOrder:et.c},e))(yt));a.d(t,"a",function(){return Tt})},2173:function(e,t,a){"use strict";var r=a(0),i=a.n(r),n=a(1),l=a.n(n),o=a(52),s=a(19),c=a.n(s),d=a(2128),u=a(55),p=a.n(u),m=a(148),b=a(31),g=a(44),O=a(2137),y=a(24),T=a(61),k=a(2),E=a(10),h=a(2163),f=a.n(h);const P=({currentPair:{key:e,type:t},marketStats:a,onClick:r})=>{let n;return t===y.d.SPOT?n=y.g:t===y.d.MARGIN?n=y.e:t===y.d.PERPETUAL&&(n=y.f),i.a.createElement("div",{className:f.a.dropdown},p()(n,n=>{const l=n.key,o=n.path,s=n.marketName,u=n.baseSymbol,p=n.quoteSymbol,g=n.tickDecimals,h=Object(O.b)({allMarketStats:a,pair:n}),P=h&&h.open&&h.last&&"0"!==h.open?Object(E.a)(h.last).minus(h.open).div(h.open).times(100):k.a.ZERO;return i.a.createElement(m.a,{key:l,to:o,onClick:r},i.a.createElement("div",{className:f.a.pairEntry},i.a.createElement("div",{className:f.a.marketNameIcon},i.a.createElement("div",{className:c()(f.a.marketIcon,{[f.a.marketIconPerp]:t===y.d.PERPETUAL})},i.a.createElement(d.a,{symbol:u})),s),i.a.createElement("div",{className:f.a.priceContainer},h&&h.last&&`${Object(E.a)(h.last).toFixed(g)} ${p}`),i.a.createElement("div",{className:f.a.changeContainer},P?i.a.createElement("div",{className:c()(f.a.percentChange,{[f.a.green]:P.gte(0),[f.a.red]:P.lt(0)})},`${P.gte(0)?"+":""}${P.toFixed(T.k)}%`):i.a.createElement("div",null),e===l?i.a.createElement("div",{className:f.a.selectedEntryCheck},i.a.createElement(b.p,null)):i.a.createElement("div",null))))}))};P.propTypes={currentPair:l.a.object.isRequired,marketStats:l.a.array,onClick:l.a.func};var v=Object(o.c)(e=>({currentPair:Object(g.e)(e),marketStats:Object(O.i)(e)}))(P),S=a(2164),R=a.n(S);class I extends r.Component{constructor(e){super(e),this.onClickOutside=(e=>{this.marketDropdownRef.current.contains(e.target)||this.setState({showMarketDropdown:!1})}),this.toggleMarketDropdown=(()=>this.setState(({showMarketDropdown:e})=>({showMarketDropdown:!e}))),this.state={showMarketDropdown:!1},this.marketDropdownRef=Object(r.createRef)()}componentWillMount(){window.addEventListener("click",this.onClickOutside)}componentWillUnmount(){window.removeEventListener("click",this.onClickOutside)}render(){const e=this.props.currentPair,t=e.key,a=e.type,r=this.state.showMarketDropdown,n=y.b[t],l=n.baseSymbol,o=n.displayQuoteSymbol;return i.a.createElement("div",{className:R.a.selectMarket},i.a.createElement("div",{className:R.a.selectMarketButtonDropdown},i.a.createElement("div",{role:"button",tabIndex:0,className:c()(R.a.selectMarketButton,{[R.a.buttonDropdownOpen]:r}),ref:this.marketDropdownRef,onClick:this.toggleMarketDropdown},l,i.a.createElement("div",{className:c()(R.a.marketIcon,{[R.a.marketIconPerp]:a===y.d.PERPETUAL})},i.a.createElement(d.a,{symbol:l})),o),r&&i.a.createElement(v,null)))}}I.propTypes={currentPair:l.a.object.isRequired};var M=Object(o.c)(e=>({currentPair:Object(g.e)(e)}))(I);a.d(t,"a",function(){return M})},2222:function(e,t,a){"use strict";var r=a(0),i=a.n(r),n=a(1),l=a.n(n),o=a(52),s=a(60),c=a(19),d=a.n(c),u=a(74),p=a(55),m=a.n(p),b=a(90),g=a.n(b),O=a(37),y=a.n(O),T=a(2132),k=a(2144),E=a(2123),h=a(617),f=a(190),P=a(45),v=a(102),S=a(44),R=a(343),I=a(616),M=a(26),A=a(42),_=a(297),N=a(24),D=a(5),L=a(11),j=a(298),C=a(388),x=a(191),w=a(10),q=a(2255),B=a.n(q);const G=({isLoading:e,hasNewTradeDiff:t,isCollateralization:a,name:n,before:l,beforeString:o,after:s,afterString:c,afterWarning:u})=>{let p;return l&&s&&(e&&!t?p="grey":s.gt(l)?p="green":s.lt(l)&&(p="red")),i.a.createElement("div",{key:n,className:d()(B.a.balanceItem,{[B.a.balanceItemHighlight]:t&&s,[B.a.grey]:e&&!t&&!s})},i.a.createElement("div",{className:B.a.name},n),i.a.createElement("div",{className:d()({[B.a.balance]:!a,[B.a.collateralization]:a})},i.a.createElement("span",null,o),p&&i.a.createElement(r.Fragment,null,i.a.createElement(h.a,{narrowContainer:!0,arrow:p}),i.a.createElement("span",{className:d()(B.a.truncatedText,{[B.a.red]:u,[B.a.grey]:e&&!t})},c))))},U=({allMarkets:e,baseMarket:t,collateralization:a,currentPair:r,currentTradeData:{newBaseMarketAccountBalance:n,newQuoteMarketAccountBalance:l,areNewBalancesValid:o,marginDeposit:s,marginDepositMarket:c,newCollateralization:u},marginAccount:p,openSidebarModal:b,pendingMarketsByAccountNumber:O,quoteMarket:h,spotAccount:P,stringGetter:S})=>{const R=r.type===N.d.SPOT,I=R?P:p,q=Object(v.d)({account:I}),U=O[(R?A.c:A.b).toFixed()],W=!!y()(I.balances,({pendingWei:e})=>e&&"0"!==e),F=!g()(U)||W;return i.a.createElement("div",{className:d()(B.a.sidebarBalances,{[B.a.sidebarSpotBalances]:R})},i.a.createElement("div",{className:B.a.sidebarBalancesContent},i.a.createElement("div",{className:B.a.title},i.a.createElement(E.a,{top:16,left:-32,tooltip:R?"spot-account-balances":"margin-account-balances"},S({key:R?D.a.SPOT_ACCOUNT_BALANCES:D.a.MARGIN_ACCOUNT_BALANCES})),F&&i.a.createElement(T.b,null)),m()(_.c,a=>{const r=Object(M.c)({allMarkets:e,symbol:a}),i=r.currency.decimals,d=Object(w.a)(Object(v.b)({account:I,market:r}).wei),u=Object(v.e)({account:I,market:r});let p,m;o?h.symbol===r.symbol?p=l:t.symbol===r.symbol&&(p=n):u.isZero()||(p=d.plus(u)),p&&(m=Object(x.e)(p,i));const b=s&&c.symbol===r.symbol&&d.gt(0)&&p&&p.lt(0);return G({isSpot:R,isLoading:!!y()(U,e=>e.id===r.id)||!u.isZero(),hasNewTradeDiff:o,name:r.symbol,before:d,beforeString:Object(x.e)(d,i),after:p,afterString:m,afterWarning:b||R&&p&&p.lt(0)})}),!R&&G({isSpot:R,isCollateralization:!0,name:i.a.createElement(E.a,{top:16,left:-38,tooltip:"trade-sidebar-collateralization"},S({key:D.a.COLLATERALIZATION})),before:a,beforeString:i.a.createElement(k.b,{collateralization:a,size:k.a.SMALL}),after:u,afterString:i.a.createElement(k.b,{size:k.a.SMALL,collateralization:u,red:u&&u.lt(L.b)})}),i.a.createElement("div",{className:B.a.buttons},i.a.createElement(f.g,{type:q?f.a.SECONDARY:f.a.PRIMARY,blue:!q,onClick:()=>b({modalType:j.a.DEPOSIT,modalProps:{product:R?C.a.SPOT:C.a.MARGIN}})},S({key:D.a.DEPOSIT})),i.a.createElement(f.g,{type:f.a.SECONDARY,disabled:!q,onClick:()=>b({modalType:j.a.WITHDRAW})},S({key:D.a.WITHDRAW})))))};U.propTypes={allMarkets:l.a.array.isRequired,baseMarket:l.a.object.isRequired,collateralization:l.a.object.isRequired,currentPair:l.a.object.isRequired,currentTradeData:l.a.object.isRequired,marginAccount:l.a.object,openSidebarModal:l.a.func.isRequired,pendingMarketsByAccountNumber:l.a.object.isRequired,quoteMarket:l.a.object.isRequired,spotAccount:l.a.object,stringGetter:l.a.func.isRequired};var W=Object(u.k)(Object(o.c)(e=>({allMarkets:Object(M.d)(e),baseMarket:Object(S.d)(e),collateralization:Object(v.s)(e),currentPair:Object(S.e)(e),currentTradeData:Object(R.b)(e),marginAccount:Object(v.r)(e),pendingMarketsByAccountNumber:Object(I.d)(e),quoteMarket:Object(S.h)(e),spotAccount:Object(v.v)(e)}),e=>Object(s.b)({openSidebarModal:P.d},e))(U)),F=a(2172),V=a(2173),Y=a(2152),z=a(31),H=a(86),K=a(33);a(2256);class Z extends r.Component{renderTabs(){const e=this.props,t=e.selectedTradeType,a=e.setTradeType,r=e.stringGetter,n=t===L.v.ISOLATED,l=d()("trade-box-tabs__tab",{"trade-box-tabs__selected-tab":n}),o=d()("trade-box-tabs__tab",{"trade-box-tabs__selected-tab":!n});return i.a.createElement("div",{className:"trade-box-tabs"},i.a.createElement("div",{tabIndex:0,role:"button",className:l,onClick:()=>a({tradeType:L.v.ISOLATED})},i.a.createElement(z.h,null),i.a.createElement("div",{className:"trade-box-tabs__text-wrapper"},r({key:D.a.ISOLATED}),i.a.createElement(E.a,{shortDelay:!0,className:"trade-box-tabs__tooltip-icon",top:12,left:-120,tooltip:"isolated"},"?"))),i.a.createElement("div",{tabIndex:0,role:"button",className:o,onClick:()=>a({tradeType:L.v.CROSS})},i.a.createElement(z.fb,null),i.a.createElement("div",{className:"trade-box-tabs__text-wrapper"},r({key:D.a.CROSS}),i.a.createElement(E.a,{shortDelay:!0,className:"trade-box-tabs__tooltip-icon",top:12,left:-254,tooltip:"cross"},"?"))))}render(){const e=this.props,t=e.isWalletReady,a=e.areAccountsLoaded,r=e.currentPair.type;return i.a.createElement("div",{className:"trade-sidebar"},i.a.createElement(V.a,null),t&&a?i.a.createElement(W,null):i.a.createElement(Y.a,{isTradePage:!0}),i.a.createElement("div",{className:d()("scroll-container",{"scroll-container-spot":r===N.d.SPOT})},r===N.d.MARGIN&&this.renderTabs(),i.a.createElement(F.a,null)))}}Z.propTypes={areAccountsLoaded:l.a.bool.isRequired,currentPair:l.a.object.isRequired,isWalletReady:l.a.bool.isRequired,selectedTradeType:l.a.oneOf(L.w).isRequired,setTradeType:l.a.func.isRequired,stringGetter:l.a.func.isRequired};t.a=Object(u.k)(Object(o.c)(e=>({areAccountsLoaded:Object(v.i)(e),currentPair:Object(S.e)(e),isWalletReady:Object(K.h)(e),selectedTradeType:Object(R.f)(e)}),e=>Object(s.b)({setTradeType:H.f},e))(Z))},2255:function(e,t,a){e.exports={sidebarBalances:"_1rmRsMRffK0l4aq9hMuEqA",sidebarSpotBalances:"_3vafOuWFJonKdeEpHnXBva",sidebarBalancesContent:"_3t1ZW3YPBU_3lWNb36LUKm",title:"ijPZ3ALWFaYgihNeM5xjN",balanceItem:"_3aQ20_kCv5WwgTVifvASLw",red:"QxfDhvYtwsr4LTzW3inFT",balance:"_13ZakkaKwB5Her1yFU7kci",collateralization:"_3DQzsfLaouoP_9EOWwozqA",truncatedText:"_2xeo7ewIVHCrHpqfhz-skH",balanceItemHighlight:"NTkUoJ5gjTR8q0Xoe_WlI",grey:"ncrR9j5Cv8VI_NY6HdES0","cell-tooltip":"Cmsn1-pZvX7QPNgsEi3zM","content-tooltip":"s6MrMZnVVSUXiZqodI2zs",buttons:"_3FB6hUg5t-xtWWhk6rY6nq"}},2256:function(e,t,a){},2478:function(e,t,a){"use strict";a.r(t);var r=a(2222);a.d(t,"default",function(){return r.a})}}]);