(window.webpackJsonp=window.webpackJsonp||[]).push([[36,15],{2122:function(e,t,a){"use strict";a.d(t,"b",function(){return d}),a.d(t,"c",function(){return p}),a.d(t,"d",function(){return u}),a.d(t,"a",function(){return m});var r=a(4),i=a.n(r),n=a(41),l=a(44),s=a(26),o=a(94),c=a(10);const d=e=>i()(e,"indexPrices.indexPrices"),p=e=>i()(e,"indexPrices.areIndexPricesLoaded"),u=Object(n.a)([l.e,d,s.d],(e,t,a)=>m({pair:e,allIndexPrices:t,allMarkets:a})),m=({pair:e,allIndexPrices:t,allMarkets:a})=>{const r=e.orderMarket,i=e.baseSymbol,n=e.quoteSymbol,l=Object(s.c)({allMarkets:a,symbol:i}),d=Object(s.c)({allMarkets:a,symbol:n}),p=t[r];if(p)return new o.a(p,l,d).getNaturalValue();const u=Object(s.c)({allMarkets:a,symbol:"DAI"});if(u&&u.oraclePrice){if("WETH-DAI"===r){if(t["WETH-USDC"])return new o.a(t["WETH-USDC"],l,Object(s.c)({allMarkets:a,symbol:"USDC"})).getNaturalValue().div(u.oraclePrice)}if("DAI-USDC"===r)return Object(c.a)(u.oraclePrice)}return null}},2125:function(e,t,a){e.exports={loadingDots:"_3jMPchhhIOb4dZOy6GLdPk",dot:"_2f58i9-DZX4n6MkcSDUG0","dot-keyframes":"j0RjL1ZlcGTCa4Xjy9tyY",newLoadingDots:"oppLNwiDeV9-rzLw4k37w","dot-animation":"_15KINsZKdzjYj3pK_pSvRH",compact:"_1WWoQQoq0KrhJIG9Mb9dfZ"}},2126:function(e,t,a){var r=a(921),i=a(619),n=a(385),l=9007199254740991,s=4294967295,o=Math.min;e.exports=function times(e,t){if((e=n(e))<1||e>l)return[];var a=s,c=o(e,s);t=i(t),e-=s;for(var d=r(c,t);++a<e;)t(a);return d}},2132:function(e,t,a){"use strict";var r=a(2126),i=a.n(r),n=a(0),l=a.n(n),s=a(1),o=a.n(s),c=a(2125),d=a.n(c);const p=({size:e=2})=>l.a.createElement("div",{className:d.a.loadingDots,style:{width:3*e+8}},i()(3,t=>l.a.createElement("div",{key:t,className:d.a.dot,style:{height:e,width:e}})));p.propTypes={size:o.a.number};var u=p,m=a(19),b=a.n(m);const g=({compact:e})=>l.a.createElement("div",{className:b()(d.a.newLoadingDots,{[d.a.compact]:e})});g.propTypes={compact:o.a.bool};var O=g;a.d(t,"b",function(){return u}),a.d(t,"a",function(){return O})},2138:function(e,t,a){"use strict";var r=a(0),i=a.n(r),n=a(1),l=a.n(n),s=a(19),o=a.n(s),c=a(2145),d=a.n(c);const p=({tag:e,children:t,extraSpacing:a})=>i.a.createElement(r.Fragment,null,t,e&&i.a.createElement("div",{className:o()(d.a.tag,{[d.a.extraSpacing]:a})},e));p.propTypes={children:l.a.oneOfType([l.a.arrayOf(l.a.node),l.a.node]).isRequired,extraSpacing:l.a.bool,tag:l.a.oneOfType([l.a.string,l.a.node])};var u=p;a.d(t,"a",function(){return u})},2143:function(e,t,a){"use strict";var r=a(231),i=a.n(r),n=a(0),l=a.n(n),s=a(1),o=a.n(s),c=a(19),d=a.n(c),p=a(2149),u=a.n(p);const m=({className:e,label:t,labelClassName:a,checked:r,onClick:n,topAlignedCheckbox:s})=>l.a.createElement("div",{className:d()(u.a.checkboxWrapper,e)},l.a.createElement("div",{className:u.a.checkbox,role:"button",tabIndex:0,onClick:n},l.a.createElement("input",{type:"checkbox",checked:r,onChange:i.a}),l.a.createElement("span",{className:d()(u.a.custom,{[u.a.topAligned]:s})}),t&&l.a.createElement("div",{className:d()(u.a.label,a)},t)));m.propTypes={checked:o.a.bool,className:o.a.string,label:o.a.oneOfType([o.a.arrayOf(o.a.node),o.a.node,o.a.string]),labelClassName:o.a.string,onClick:o.a.func.isRequired,topAlignedCheckbox:o.a.bool};var b=m;a.d(t,"a",function(){return b})},2145:function(e,t,a){e.exports={tag:"_2ukp2icrWLdgvD3odSm2Hm",extraSpacing:"_18tcZvIMJWLJT8DSy4PNW3"}},2146:function(e,t,a){},2149:function(e,t,a){e.exports={checkboxWrapper:"vNRaxmHo46U6RappONKFH",checkbox:"_19RMSXPBlUqYk12l-xPHYr",custom:"_2kl9Enu9XNPp7I5yxjjUlj",topAligned:"_3mLmd2r1moWl1-lllnQKfj",label:"_2h1JC1J1RFcB8X-C9rrGQk"}},2150:function(e,t,a){e.exports={animatedToggle:"_2uX6PC8cA8YPCtdcDGUDVn",toggled:"_3NWbtL9arP0Eum-jEVhUtn",grayscale:"_4TrMjUnhys9QgRpb_qejA",label:"_3pd4To_unYOQ9_wOU2cXJO",compact:"_2cnM-EVr5tBuRyrxovo9uS"}},2152:function(e,t,a){"use strict";var r=a(0),i=a.n(r),n=a(1),l=a.n(n),s=a(52),o=a(60),c=a(19),d=a.n(c),p=a(74),u=a(384),m=a(190),b=a(45),g=a(33),O=a(44),y=a(296),k=a(102),E=a(24),T=a(5),h=a(38);a(2146);const P=({areAccountsLoaded:e,arePerpBalancesLoaded:t,arePerpMarketsLoaded:a,currentPair:{type:r},isBorrowPage:n,isPerpPage:l,isTradePage:s,isWalletConnecting:o,isWalletIncorrectNetwork:c,isWalletInvalid:p,isWalletReady:b,openModal:g,stringGetter:O,withBorder:y})=>{const k=d()("component-sidebar-wallet-ctas",{"component-sidebar-wallet-ctas__with-border":y,"component-sidebar-wallet-ctas__trade":s,"component-sidebar-wallet-ctas__perp":l,"component-sidebar-wallet-ctas__spot":!n&&r===E.d.SPOT});return c?i.a.createElement("div",{className:k},i.a.createElement("div",{className:"cta-content"},O({key:T.a.CHANGE_NETWORK_REQUEST}))):!o&&p?i.a.createElement("div",{className:k},i.a.createElement("div",{className:"cta-content"},O({key:T.a.GET_STARTED_DESCRIPTION})),i.a.createElement("div",null,i.a.createElement(m.g,{blue:!0,className:"connect-wallet-button",onClick:()=>g({type:h.a.CONNECT_WALLET})},O({key:T.a.CONNECT_WALLET})))):!o&&b&&(l?a&&t:e)?null:i.a.createElement("div",{className:k},i.a.createElement("div",{className:"cta-content"},i.a.createElement(u.a,null)))};P.defaultProps={withBorder:!0},P.propTypes={areAccountsLoaded:l.a.bool.isRequired,arePerpBalancesLoaded:l.a.bool.isRequired,arePerpMarketsLoaded:l.a.bool.isRequired,currentPair:l.a.object.isRequired,isBorrowPage:l.a.bool,isPerpPage:l.a.bool,isTradePage:l.a.bool,isWalletConnecting:l.a.bool.isRequired,isWalletIncorrectNetwork:l.a.bool.isRequired,isWalletInvalid:l.a.bool.isRequired,isWalletReady:l.a.bool.isRequired,openModal:l.a.func.isRequired,stringGetter:l.a.func.isRequired,withBorder:l.a.bool};var f=Object(p.k)(Object(s.c)(e=>({areAccountsLoaded:Object(k.i)(e),arePerpBalancesLoaded:Object(y.c)(e),arePerpMarketsLoaded:Object(y.d)(e),currentPair:Object(O.e)(e),isWalletConnecting:Object(g.e)(e),isWalletIncorrectNetwork:Object(g.f)(e),isWalletInvalid:Object(g.g)(e),isWalletReady:Object(g.h)(e)}),e=>Object(o.b)({openModal:b.c},e))(P));a.d(t,"a",function(){return f})},2153:function(e,t,a){"use strict";var r=a(0),i=a.n(r),n=a(1),l=a.n(n),s=a(19),o=a.n(s),c=a(2150),d=a.n(c);const p=({className:e,compact:t,grayscale:a,isToggledRight:r,leftLabel:n,onClickLeft:l,onClickRight:s,rightLabel:c})=>i.a.createElement("div",{className:o()(d.a.animatedToggle,{[d.a.toggled]:r,[d.a.grayscale]:a,[d.a.compact]:t},e)},i.a.createElement("div",{role:"button",tabIndex:0,className:d.a.label,onClick:l},n),i.a.createElement("div",{role:"button",tabIndex:0,className:d.a.label,onClick:s},c));p.propTypes={className:l.a.string,compact:l.a.bool,grayscale:l.a.bool,isToggledRight:l.a.bool,leftLabel:l.a.oneOfType([l.a.string,l.a.node]).isRequired,onClickLeft:l.a.func.isRequired,onClickRight:l.a.func.isRequired,rightLabel:l.a.oneOfType([l.a.string,l.a.node]).isRequired};var u=p;a.d(t,"a",function(){return u})},2163:function(e,t,a){e.exports={dropdown:"_1bDdh5nYnDoQPasNegtesO",pairEntry:"MlQzEhmgD54Z_7Vjdkg4v",marketNameIcon:"_2CGihejg78xcuReXJ-I4A-",marketIcon:"_1PT28MDH5ajkWUdca3wUDH",marketIconPerp:"_3jFoxkwsboUZdn84dSmw9N",priceContainer:"_3thVNRhdg-9vUsxPkS5Sr5",changeContainer:"_3KJb-Ugk3JWSc16uCwq8pt",percentChange:"_20wHTcDc9-9tMSTIZRhukZ",green:"_1ofSXY8MpqyE8wBB-Bf0qf",red:"_3mgukL4c2j2iQUlH7zk3gT",selectedEntryCheck:"NriznvnNx5anjGeVLd89P"}},2164:function(e,t,a){e.exports={selectMarket:"_3VTmhdaPb6jsKr_xWs7O4s",selectMarketButtonDropdown:"_2c9nPvfS0xREcVBT0UV0Th",selectMarketButton:"_3otHCMFe5i-y9MuVHLnwDT",buttonDropdownOpen:"_2ukGPwyHMU-X7PDKk9KVqn",symbol:"_1KyaoMW9ey14gBxUpsnhIP",symbolLeft:"lKQgak8Xz8OZwGwLy9zAk",marketIcon:"a02BZ1WRbWeqd9OIqZGPr",marketIconPerp:"_2Y49FczbTgR88wNJXMmWr2"}},2165:function(e,t,a){e.exports={productUnavailable:"_1CMeWrBVL3aPcbGjV1gSxC",text:"_2SOpRg2GW_SfGzHF_c4h-A"}},2166:function(e,t,a){e.exports={perpetualLeverageSlider:"_1U7TbKmmnqSpgqUSMzMGnl",leverageLabel:"_3SS4uL0oiVJ95ZZpN8c2MH",leverageBadge:"_24lBUpwb_4ulI1dQjyW5FW",leverageBadgeLong:"_1mSLMt9CMuA--sISM8xxbk",leverageBadgeShort:"_2DCxw1Av9qUfcCIT2PF7US",labels:"_2qMVcLKoCXviMD57PW0hHI",label:"aHAZB2Puou6lpxYWCzUnX",dots:"_3Exz7KbogeEsI9jsg4IV2y",dot:"_3hSuMH5NWlLCVFvsIPBpJ-"}},2167:function(e,t,a){e.exports={tradeReceipt:"_2yaua8HwORaH7jJ7NwfOj1",row:"VECzWHOu1NYOqt4QMDpJL",title:"_2yqVWTegM_6-T7pfXfUzhe",value:"lL-Ev8uaBnxL2usqFe_xi",red:"_V15lf8hBhJzUQHozGZEV",badge:"_1WITnQD-qzACgA3Tyha60u",badgeGradient:"QKC-IeLKiz2ZeiO1dkMvH"}},2168:function(e,t,a){},2169:function(e,t,a){e.exports={slidingTabs:"tlLiCocP8Y6yD1BqIOJOd",twoTabs:"_2AB8qMvzSs9mlUfRd9oyim",threeTabs:"_2r_2I2ObnCAflzw6yh_6uJ","selectedIndex--1":"_2YCmapsZytOs1cDrNdC9IW","selectedIndex--2":"_2OgA-aYVumFpXox1o6dCc8",tab:"_3YmH3d966IPzt4Sy5Nb5hD",selected:"_3Iu8gYmW-eRtXTaTMQkyMz"}},2170:function(e,t,a){e.exports={leverageGrid:"_1fb1gpofDClK2ZVyTFjtDH"}},2171:function(e,t,a){},2172:function(e,t,a){"use strict";var r=a(231),i=a.n(r),n=a(112),l=a.n(n),s=a(4),o=a.n(s),c=a(0),d=a.n(c),p=a(1),u=a.n(p),m=a(52),b=a(60),g=a(19),O=a.n(g),y=a(9),k=a.n(y),E=a(74),T=a(31),h=a(250),P=a(44),f=a(5),v=a(24),R=a(2165),S=a.n(R);const I=({currentPair:e,isUserInUsa:t,stringGetter:a})=>e.type===v.d.PERPETUAL&&t?d.a.createElement("div",{className:S.a.productUnavailable},d.a.createElement(T.a,null),d.a.createElement("div",{className:S.a.text},a({key:f.a.PERPETUAL_NOT_AVAILABLE})," ",a({key:f.a.MORE_DETAILS_TOS}),d.a.createElement("a",{href:"https://dydx.exchange/terms-of-use/",target:"_blank",rel:"noopener noreferrer"},d.a.createElement(T.ub,null)))):null;I.propTypes={currentPair:u.a.object.isRequired,isUserInUsa:u.a.bool.isRequired,stringGetter:u.a.func.isRequired};var M=Object(E.k)(Object(m.c)(e=>({currentPair:Object(P.e)(e),isUserInUsa:Object(h.c)(e)}))(I)),D=a(2126),_=a.n(D),A=a(621),L=a.n(A),N=a(2501),j=a(2500),C=a(2261),x=a(2123),w=a(2127),q=a(86),B=a(296),U=a(26),G=a(2122),W=a(343),F=a(132),V=a(171),Y=a(61),H=a(2),K=a(615),z=a(10),Z=a(46),$=a(2166),X=a.n($);const Q=Object(C.a)({rail:{height:6,background:"linear-gradient(90deg, #ff5757, #616774, #57ff5f)",opacity:1,borderRadius:4},thumb:{zIndex:1,marginTop:-3,backgroundColor:"#ffffff","&:hover":{boxShadow:"0 0 5px #959eb1"},"&:active":{boxShadow:"none"}},valueLabel:{top:8,fontSize:11,left:"calc(-50% - 12px)"}})(N.a),J=Object(C.a)({tooltip:{backgroundColor:"#17181a",margin:"8px 0",fontSize:11,fontFamily:"Roboto Mono"}})(j.a),ee=({children:e,open:t,value:a})=>d.a.createElement(J,{open:t,enterTouchDelay:0,placement:"bottom",title:a},e);class te extends c.Component{constructor(e){super(e),this.getPositionLeverage=(({amount:e,price:t,side:a}={})=>{const r=this.props,i=r.allIndexPrices,n=r.arePerpetualBalancesLoaded,l=r.currentPair,s=l.orderMarket,o=l.isInversePerpetual,c=r.perpetualBalances;if(!n)return H.a.ZERO;const d=c[s],p=d.margin,u=d.position,m=i[s];let b=Object(z.a)(u),g=Object(z.a)(p);if(e&&t&&a){const r=o?e.div(t.baseAmount):e.times(t.baseAmount);b=a===H.f.SELL?b.minus(e):b.plus(e),g=a===H.f.SELL?g.plus(r):g.minus(r)}const O=Object(K.c)({positionBN:b,marginBN:g,indexPrice:m,isInversePerpetual:o});return O||H.a.ZERO}),this.onChangeLeverage=((e,t)=>{const a=this.props,r=a.allIndexPrices,i=a.allMarkets,n=a.allOrderbookOrders,l=a.perpetualBalances,s=a.currentPair,o=a.setTradeData,c=s.orderMarket,d=s.isInversePerpetual,p=s.baseSymbol,u=s.quoteSymbol,m=l[c]||{},b=m.margin,g=m.position,O=r[c],y=Object(U.c)({allMarkets:i,symbol:d?u:p}),k=Object(z.a)(g),E=Object(z.a)(b);let T,h;d?(T=k,h=E.times(O)):(T=k.times(O),h=E);const P=Object(z.a)(t),f=this.getPositionLeverage();let v,R;v=P.gt(f)?P.times(T.plus(h)).minus(T):T.minus(P.times(T.plus(h))),d||(v=v.div(O)),R=d?P.gt(k.lt(0)?f:-1*f)?H.f.BUY:H.f.SELL:P.gt(k.gte(0)?f:-1*f)?H.f.BUY:H.f.SELL;let S=Object(F.a)({allOrderbookOrders:n,allMarkets:i,pair:s,side:R,amount:v});const I=this.getPositionLeverage({amount:v,price:S,side:R});S&&I&&!I.dp(Y.e).eq(P.abs())&&(v=d?S.baseAmount.times(P.times(h).plus(P.times(T)).plus(T)).div(P.times(S.baseAmount).plus(S.baseAmount).minus(P.times(O))):P.gt(f)?P.times(h.plus(T)).minus(T).div(S.baseAmount.times(P).minus(P.times(O)).plus(O)):P.abs().times(h.plus(T)).minus(T).div(P.minus(1).times(O).minus(S.baseAmount.times(P))),S=Object(F.a)({allOrderbookOrders:n,allMarkets:i,pair:s,side:R,amount:v.abs()})),o({amount:v.abs(),amountDisplayValue:Object(Z.a)(v,y.currency.decimals).toFixed(Y.n),selectedPerpetualLeverage:P,side:R,price:S})}),this.onChangeLeverage=L()(this.onChangeLeverage,100)}render(){const e=this.props,t=e.allIndexPrices,a=e.allMarkets,r=e.arePerpetualBalancesLoaded,i=e.arePerpetualMarketsLoaded,n=e.currentPair,s=e.currentTradeData,o=e.perpetualBalances,c=e.perpetualMarkets,p=e.stringGetter,u=n.maxLeverage,m=s.selectedPerpetualLeverage;let b=m;if(l()(b)&&r&&i){const e=Object(K.h)({allIndexPrices:t,allMarkets:a,currentPair:n,perpetualBalances:o,perpetualMarkets:c,currentTradeData:s}),r=e.positionLeverage,i=e.positionSide,l=e.newPositionLeverage,d=e.newPositionSide;b=e.hasOrderDiff?d===V.d.SHORT?l.negated():l:i===V.d.SHORT?r.negated():r}const g=[];return _()(11,e=>g.push(d.a.createElement("div",{key:e,className:X.a.dot}))),d.a.createElement(w.c,{label:d.a.createElement(x.a,{className:X.a.leverageLabel,top:8,left:-48,tooltip:"perpetual-leverage-slider"},p({key:f.a.LEVERAGE}),m&&!m.isZero()&&d.a.createElement("div",{className:O()(X.a.leverageBadge,{[X.a.leverageBadgeShort]:m.lt(0),[X.a.leverageBadgeLong]:m.gt(0)})},p({key:m.lt(0)?f.a.SHORT:f.a.LONG})))},d.a.createElement("div",{className:X.a.perpetualLeverageSlider},d.a.createElement(Q,{track:!1,ValueLabelComponent:ee,min:u.negated().toNumber(),max:u.toNumber(),step:.1,valueLabelFormat:e=>`${Math.abs(e).toFixed(Y.e)}\xd7`,value:b?b.toNumber():0,onChange:this.onChangeLeverage,valueLabelDisplay:"auto"}),d.a.createElement("div",{className:X.a.dots},g)),d.a.createElement("div",{className:X.a.labels},d.a.createElement("div",{className:X.a.label},u.toFixed(0),"\xd7"),d.a.createElement("div",{className:X.a.label},"0\xd7"),d.a.createElement("div",{className:X.a.label},u.toFixed(0),"\xd7")))}}te.propTypes={allIndexPrices:u.a.object.isRequired,allMarkets:u.a.array.isRequired,allOrderbookOrders:u.a.object.isRequired,arePerpetualBalancesLoaded:u.a.bool.isRequired,arePerpetualMarketsLoaded:u.a.bool.isRequired,currentPair:u.a.object.isRequired,currentTradeData:u.a.object.isRequired,perpetualBalances:u.a.object.isRequired,perpetualMarkets:u.a.object.isRequired,setTradeData:u.a.func.isRequired,stringGetter:u.a.func.isRequired};var ae=Object(E.k)(Object(m.c)(e=>({allIndexPrices:Object(G.b)(e),allMarkets:Object(U.d)(e),allOrderbookOrders:Object(F.d)(e),arePerpetualBalancesLoaded:Object(B.c)(e),arePerpetualMarketsLoaded:Object(B.d)(e),currentPair:Object(P.e)(e),currentTradeData:Object(W.b)(e),perpetualBalances:Object(B.e)(e),perpetualMarkets:Object(B.g)(e)}),e=>Object(b.b)({setTradeData:q.e},e))(te)),re=a(34),ie=a(232),ne=a(33),le=a(11),se=a(150),oe=a(57),ce=a(94),de=a(386),pe=a(614),ue=a(301),me=a(2167),be=a.n(me);const ge=({allPairOrderData:e,orderMarket:t,isPerpetual:a=!1})=>{const r=e[t]||{};return Object(Z.a)(r.smallOrderThreshold||0,a?r.decimals:o()(r,"baseCurrency.decimals",0))};class Oe extends c.Component{renderRow({title:e,value:t,tooltipConfig:{tooltip:a,top:r,left:i,stringParams:n,learnMoreLink:l}={}}){return t?d.a.createElement("div",{className:be.a.row},d.a.createElement("div",{className:be.a.title},a?d.a.createElement(x.a,{top:r,left:i,tooltip:a,stringParams:n,learnMoreLink:l},e):e),d.a.createElement("div",{className:be.a.value},t)):null}renderMarginDeposit(){const e=this.props,t=e.currentTradeData.marginDeposit,a=e.stringGetter;return t?this.renderRow({title:a({key:f.a.MARGIN_DEPOSIT}),value:`${t.getNaturalValue().toFixed(Y.n)} ${t.market.symbol}`,tooltipConfig:{tooltip:"margin-deposit",top:8,left:-48}}):null}renderTradeAmount(){const e=this.props,t=e.allPairOrderData,a=e.baseMarket,r=e.currentPair.orderMarket,i=e.currentTradeData.amount,n=e.selectedTradeType,l=e.stringGetter,s=e.tradeAmount,o=(t[r]||{}).minimumOrderSize,c=n===le.v.ISOLATED&&i&&!i.isZero()&&new oe.a(s,a);return c&&this.renderRow({title:l({key:f.a.TRADE_AMOUNT}),value:d.a.createElement("div",{className:O()({[be.a.red]:c.baseAmount.lt(o)})},c.getNaturalValue().toFixed(Y.n)," ",c.market.symbol),tooltipConfig:{tooltip:"isolated-trade-amount",top:8,left:-48}})}renderExpectedPrice(){const e=this.props,t=e.currentPair,a=t.type,r=t.tickDecimals,i=t.displayQuoteSymbol,n=e.currentTradeData,l=n.tradeOrderType,s=n.price,o=e.selectedTradeType,c=e.stringGetter,d=(o===le.v.ISOLATED||a===v.d.PERPETUAL&&l===le.u.MARKET)&&s;return d&&d.baseAmount.isFinite()&&this.renderRow({title:c({key:f.a.EXPECTED_PRICE}),value:`${d.getNaturalValue().toFixed(r)} ${i}`,tooltipConfig:{tooltip:"slippage-expected-price",top:8,left:-48,learnMoreLink:"https://help.dydx.exchange/trading-faq/spread-price-impact-and-slippage"}})}renderIndexPrice(){const e=this.props,t=e.baseMarket,a=e.quoteMarket,r=e.currentPair,i=r.displayQuoteSymbol,n=r.tickDecimals,l=e.currentTradeData.tradeOrderType,s=e.indexPriceNatural,o=e.stringGetter,c=l===le.u.STOP&&ce.a.fromNaturalValue(s,t,a);return c&&c.baseAmount.isFinite()&&this.renderRow({title:o({key:f.a.INDEX_PRICE}),value:`${c.getNaturalValue().toFixed(n)} ${i}`,tooltipConfig:{tooltip:"index-price",top:8,left:-48}})}renderInitialStopPrice(){const e=this.props,t=e.currentPair,a=t.displayQuoteSymbol,r=t.tickDecimals,i=e.currentTradeData,n=i.triggerPriceMP,l=i.trailingPercent,s=e.stringGetter;return l&&!l.isZero()&&n&&this.renderRow({title:s({key:f.a.INITIAL_STOP_PRICE}),value:`${n.getNaturalValue().toFixed(r)} ${a}`,tooltipConfig:{tooltip:"initial-stop-price",top:8,left:-48}})}renderWorstPrice(){const e=this.props,t=e.currentPair,a=t.displayQuoteSymbol,r=t.tickDecimals,i=e.currentTradeData,n=i.side,l=i.price,s=i.tradeOrderType,o=i.triggerPriceMP,c=e.slippage,d=e.stopSlippage,p=e.stringGetter;let u=null;return s===le.u.MARKET&&l?u=l.getMarketPriceWithSlippage(c,n):s===le.u.STOP&&o&&(u=o.getMarketPriceWithSlippage(d,n)),u&&u.baseAmount.isFinite()&&this.renderRow({title:p({key:f.a.WORST_PRICE}),value:`${u.getNaturalValue().toFixed(r)} ${a}`,tooltipConfig:{tooltip:"slippage-worst-price",top:8,left:-48,learnMoreLink:"https://help.dydx.exchange/trading-faq/spread-price-impact-and-slippage"}})}renderTotal({feeAmount:e,isTaker:t}){const a=this.props,r=a.baseMarket,i=a.currentPair,n=i.displayQuoteSymbol,l=i.tickDecimals,s=i.isInversePerpetual,o=a.currentTradeData,c=o.side,d=o.price,p=o.amount,u=o.tradeOrderType,m=o.limitPrice,b=o.triggerPriceMP,g=a.quoteMarket,O=a.selectedTradeType,y=a.stringGetter;let k,E,T;return O===le.v.CROSS&&p&&(u===le.u.MARKET&&d?E=d.baseAmount:u===le.u.LIMIT&&m?E=m.baseAmount:u===le.u.STOP&&b&&(E=b.baseAmount),E&&(k=s?p.div(E):p.times(E))),k&&(T=s?new oe.a(k,r):new oe.a(c===H.f.BUY?k.plus(e?e.baseAmount:0):k.minus(e?e.baseAmount:0),g)),T&&this.renderRow({title:y({key:f.a.TOTAL}),value:`${u!==le.u.LIMIT||t?"\u2248 ":""}${T.getNaturalValue().toFixed(Math.max(l,Y.f))} ${s?T.market.symbol:n}`})}renderLiquidationPrice(){const e=this.props,t=e.currentPair,a=t.baseSymbol,r=t.displayQuoteSymbol,i=t.tickDecimals,n=e.currentTradeData.side,l=e.liquidationPrice,s=e.stringGetter;return l&&l.baseAmount.isFinite()&&this.renderRow({title:s({key:f.a.LIQUIDATION_PRICE}),value:`${l.getNaturalValue().toFixed(i)} ${r}`,tooltipConfig:{tooltip:n===H.f.BUY?"liquidation-price-long":"liquidation-price-short",top:8,left:-48,stringParams:{SYMBOL:a}}})}renderPriceImpact(){const e=this.props,t=e.priceImpact,a=e.stringGetter;return t&&this.renderRow({title:a({key:f.a.PRICE_IMPACT}),value:d.a.createElement("div",{className:O()({[be.a.red]:t.abs().gt(le.r)})},t.abs().times(100).toFixed(Y.k),"%"),tooltipConfig:{tooltip:"price-impact",top:8,left:-48}})}renderInterest(){const e=this.props,t=e.baseMarket,a=e.quoteMarket,r=e.selectedTradeType,i=e.currentTradeData,n=i.side,l=i.amount,s=i.price,o=i.marginDeposit,c=e.stringGetter,d=Object(de.a)({tradeType:r,price:s,side:n,amount:l,marginDepositMV:o}),p=d.debtWei,u=d.collateralWei;let m,b;n===H.f.SELL?(m=t,b=a):n===H.f.BUY&&(m=a,b=t);const g=Object(de.d)({borrowMarket:m,supplyMarket:b,debtWei:p,collateralWei:u});return r===le.v.ISOLATED&&g&&!g.isZero()&&this.renderRow({title:c({key:f.a.INTEREST_RATE_APR}),value:`${g.lt(0)?"+":""}${g.negated().times(100).toFixed(Y.k)}%`,tooltipConfig:{tooltip:"interest-rate",top:-148,left:-48,stringParams:{SUPPLY_SYMBOL:b.symbol,BORROW_SYMBOL:m.symbol}}})}renderFeesFields({feeAmount:e,feePercentage:t,isTaker:a,isSmallOrder:r}){const i=this.props,n=i.allPairOrderData,l=i.currentPair,s=l.orderMarket,o=l.displayQuoteSymbol,p=l.tickDecimals,u=l.type,m=l.isInversePerpetual,b=i.stringGetter,g=i.walletData,y=u===v.d.PERPETUAL;let k,E,T,h="";t&&(y&&!a?(k=b({key:f.a.MAKER}),h="fee-maker-rebate",E=-96):r?(k=b({key:f.a.SMALL_ORDER}),h="fee-small-order",E=-148,T={ETH_THRESHOLD:ge({allPairOrderData:n,orderMarket:"WETH-DAI"}),DAI_THRESHOLD:ge({allPairOrderData:n,orderMarket:"DAI-USDC"}),USD_THRESHOLD:ge({allPairOrderData:n,orderMarket:"WETH-PUSD",isPerpetual:!0}),BTC_THRESHOLD:ge({allPairOrderData:n,orderMarket:"PBTC-USDC",isPerpetual:!0})}):(k=b(a?{key:f.a.TAKER}:{key:f.a.MAKER}),h=a?"fee-taker":"fee-maker",E=a?-96:-84));const P=Y.m,R=Math.max(p,P),S=g[se.e.HAS_SET_REFERRER];return d.a.createElement(c.Fragment,null,t&&this.renderRow({title:d.a.createElement(c.Fragment,null,b({key:f.a.FEE})," ",d.a.createElement("div",{className:be.a.badge},k),"WETH-PUSD"!==s&&S&&a&&d.a.createElement("div",{className:O()(be.a.badge,be.a.badgeGradient)},"10% OFF"),"PLINK-USDC"===s&&a&&d.a.createElement("div",{className:O()(be.a.badge,be.a.badgeGradient)},"50% OFF")),value:t.isZero()?b({key:f.a.FREE}):d.a.createElement("div",{className:O()({[be.a.red]:t.gte(le.h)})},t.times(100).toFixed(R),"%"),tooltipConfig:{tooltip:h,top:E,left:-48,stringParams:T}}),e&&this.renderRow({title:b({key:f.a.FEE_AMOUNT}),value:`\u2248 ${e.getNaturalValue().toFixed(R)} ${m?e.market.symbol:o}`}))}renderExpiration(){const e=this.props,t=e.canBypass28DayRequirement,a=e.selectedTradeType,r=e.stringGetter;let i;if(a===le.v.ISOLATED){const e=re.DateTime.local().plus({days:H.b}),a=Object(pe.c)({expiration:e,stringGetter:r}),n=a.timeString,l=a.unitString;i=t?r({key:f.a.NONE}):`${n} ${l}`}return i&&this.renderRow({title:r({key:f.a.EXPIRY}),value:i,tooltipConfig:{tooltip:"expiration",top:-108,left:-48}})}render(){const e=this.props,t=e.allOrderbookOrders,a=e.allPairOrderData,r=e.baseMarket,i=e.currentPair,n=e.currentTradeData,l=e.isLeverageValid,s=e.quoteMarket,o=e.selectedTradeType,c=e.tradeAmount,p=e.walletData,u=e.walletAddress;if(!l)return d.a.createElement("div",{className:be.a.tradeReceipt},this.renderExpiration());const m=Object(ue.a)({allOrderbookOrders:t,allPairOrderData:a,baseMarket:r,currentPair:i,currentTradeData:n,quoteMarket:s,selectedTradeType:o,tradeAmount:c,walletData:p,walletAddress:u}),b=m.feeAmount,g=m.feePercentage,O=m.isTaker,y=m.isSmallOrder;return d.a.createElement("div",{className:be.a.tradeReceipt},this.renderMarginDeposit(),this.renderTradeAmount(),this.renderExpectedPrice(),this.renderIndexPrice(),this.renderInitialStopPrice(),this.renderWorstPrice(),this.renderLiquidationPrice(),this.renderPriceImpact(),this.renderInterest(),this.renderFeesFields({feeAmount:b,feePercentage:g,isTaker:O,isSmallOrder:y}),this.renderTotal({feeAmount:b,isTaker:O}),this.renderExpiration())}}Oe.propTypes={allOrderbookOrders:u.a.object.isRequired,allPairOrderData:u.a.object.isRequired,baseMarket:u.a.object.isRequired,canBypass28DayRequirement:u.a.bool.isRequired,currentPair:u.a.object.isRequired,currentTradeData:u.a.object.isRequired,isLeverageValid:u.a.bool.isRequired,liquidationPrice:u.a.object,indexPriceNatural:u.a.object,priceImpact:u.a.object,quoteMarket:u.a.object.isRequired,selectedTradeType:u.a.string.isRequired,slippage:u.a.object.isRequired,stopSlippage:u.a.object.isRequired,stringGetter:u.a.func.isRequired,tradeAmount:u.a.object,walletData:u.a.object,walletAddress:u.a.string};var ye=Object(E.k)(Object(m.c)(e=>({allOrderbookOrders:Object(F.d)(e),allPairOrderData:Object(P.c)(e),baseMarket:Object(P.d)(e),canBypass28DayRequirement:Object(h.a)(e),currentPair:Object(P.e)(e),currentTradeData:Object(W.b)(e),indexPriceNatural:Object(G.d)(e),quoteMarket:Object(P.h)(e),selectedTradeType:Object(W.f)(e),walletData:Object(ie.b)(e),walletAddress:Object(ne.m)(e)}))(Oe)),ke=a(2153),Ee=a(2143),Te=a(2135),he=a(2139),Pe=a.n(he);a(2168);function _slicedToArray(e,t){return function _arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var a=[],r=!0,i=!1,n=void 0;try{for(var l,s=e[Symbol.iterator]();!(r=(l=s.next()).done)&&(a.push(l.value),!t||a.length!==t);r=!0);}catch(o){i=!0,n=o}finally{try{r||null==s.return||s.return()}finally{if(i)throw n}}return a}(e,t)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}const fe=({label:e,badge:t,children:a,largeText:r,onClick:i})=>{const n=_slicedToArray(Object(c.useState)(!1),2),l=n[0],s=n[1];return d.a.createElement("div",{className:"component-expandable-menu"},d.a.createElement("div",{role:"button",tabIndex:0,className:O()("label",{label__expanded:l,"label__large-text":r}),onClick:()=>{i&&i(),s(!l)}},e,d.a.createElement("div",{className:"right-container"},t&&d.a.createElement("div",{className:O()("badge",{badge__activated:t.isActive})},t.label),d.a.createElement(T.m,null))),d.a.createElement(Pe.a,{isOpened:l},d.a.createElement("div",{className:"menu-content"},a)))};fe.propTypes={badge:u.a.shape({label:u.a.string.isRequired,isActive:u.a.bool}),children:u.a.oneOfType([u.a.arrayOf(u.a.node),u.a.node]).isRequired,label:u.a.string.isRequired,largeText:u.a.bool,onClick:u.a.func};var ve=fe,Re=a(55),Se=a.n(Re),Ie=a(97),Me=a.n(Ie),De=a(39),_e=a.n(De),Ae=a(2169),Le=a.n(Ae);const Ne=({className:e,tabConfig:t,selectedTabKey:a,onClick:r})=>d.a.createElement("div",{className:O()(Le.a.slidingTabs,{[Le.a.twoTabs]:2===_e()(t),[Le.a.threeTabs]:3===_e()(t)},Le.a[`selectedIndex--${Me()(t,({key:e})=>e===a)}`],e)},Se()(t,({key:e,label:t})=>d.a.createElement("div",{key:e,role:"button",tabIndex:0,className:O()(Le.a.tab,{[Le.a.selected]:a===e}),onClick:()=>r(e)},t)));Ne.propTypes={className:u.a.string,tabConfig:u.a.arrayOf(u.a.shape({key:u.a.string.isRequired,label:u.a.string.isRequired})).isRequired,selectedTabKey:u.a.string.isRequired,onClick:u.a.func.isRequired};var je=Ne,Ce=a(190),xe=a(2170),we=a.n(xe);const qe=({buttonConfig:e,largeText:t,maxSlippage:a,onChangeInput:r,onClickButton:i,slippage:n,slippageInput:l,stringGetter:s,tooltip:o="max-slippage"})=>d.a.createElement(w.c,{grey:t,label:d.a.createElement(x.a,{top:8,left:-48,tooltip:o},s({key:f.a.MAXIMUM_SLIPPAGE})),size:t?w.a.MEDIUM:w.a.SMALL},d.a.createElement("div",{className:we.a.leverageGrid},Se()(e,({label:e,value:t})=>d.a.createElement(Ce.g,{key:t,type:Ce.a.SECONDARY,selected:""===l&&n.eq(t),onClick:()=>i(t)},e)),d.a.createElement(Ce.h,{type:Ce.a.SECONDARY,onChange:e=>{const t=e.slice(0,-1);r(t)},placeholder:s({key:f.a.CUSTOM_INPUT}),selected:""!==l,max:a,value:l,suffix:"%"})));qe.propTypes={buttonConfig:u.a.arrayOf(u.a.shape({label:u.a.string,value:u.a.number})).isRequired,largeText:u.a.bool,maxSlippage:u.a.number,onChangeInput:u.a.func.isRequired,onClickButton:u.a.func.isRequired,slippage:u.a.object,slippageInput:u.a.string,stringGetter:u.a.func.isRequired,tooltip:u.a.string};var Be=Object(E.k)(qe),Ue=a(618),Ge=a(79);function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function _objectWithoutProperties(e,t){if(null==e)return{};var a,r,i=function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var a,r,i={},n=Object.keys(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var We=d.a.createElement("rect",{width:16,height:16,rx:4,fill:"#4280F9"}),Fe=d.a.createElement("path",{d:"M8 13C10.7614 13 13 10.7614 13 8C13 5.23858 10.7614 3 8 3C5.23858 3 3 5.23858 3 8C3 10.7614 5.23858 13 8 13Z",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round"}),Ve=d.a.createElement("path",{d:"M8 5V8L10 9",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round"}),Ye=function SvgGoodTil(e){var t=e.svgRef,a=_objectWithoutProperties(e,["svgRef"]);return d.a.createElement("svg",_extends({width:16,height:16,viewBox:"0 0 16 16",fill:"none",ref:t},a),We,Fe,Ve)},He=d.a.forwardRef(function(e,t){return d.a.createElement(Ye,_extends({svgRef:t},e))});a.p;function fill_or_kill_extends(){return(fill_or_kill_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function fill_or_kill_objectWithoutProperties(e,t){if(null==e)return{};var a,r,i=function fill_or_kill_objectWithoutPropertiesLoose(e,t){if(null==e)return{};var a,r,i={},n=Object.keys(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var Ke=d.a.createElement("rect",{width:16,height:16,rx:4,fill:"#FF5757"}),ze=d.a.createElement("path",{d:"M4 9H7V12",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round"}),Ze=d.a.createElement("path",{d:"M12 7H9V4",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round"}),$e=d.a.createElement("path",{d:"M9 7L12.5 3.5",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round"}),Xe=d.a.createElement("path",{d:"M3.5 12.5L7 9",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round"}),Qe=function SvgFillOrKill(e){var t=e.svgRef,a=fill_or_kill_objectWithoutProperties(e,["svgRef"]);return d.a.createElement("svg",fill_or_kill_extends({width:16,height:16,viewBox:"0 0 16 16",fill:"none",ref:t},a),Ke,ze,Ze,$e,Xe)},Je=d.a.forwardRef(function(e,t){return d.a.createElement(Qe,fill_or_kill_extends({svgRef:t},e))}),et=(a.p,a(83)),tt=a(49),at=a(45),rt=a(102),it=a(249),nt=a(21),lt=a(38),st=a(279),ot=a(32);const ct=window.crypto||window.msCrypto;var dt=a(85),pt=a(103),ut=a(25),mt=a(170);a(2171);function trade_box_objectWithoutProperties(e,t){if(null==e)return{};var a,r,i=function trade_box_objectWithoutPropertiesLoose(e,t){if(null==e)return{};var a,r,i={},n=Object.keys(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function asyncGeneratorStep(e,t,a,r,i,n,l){try{var s=e[n](l),o=s.value}catch(c){return void a(c)}s.done?t(o):Promise.resolve(o).then(r,i)}function _asyncToGenerator(e){return function(){var t=this,a=arguments;return new Promise(function(r,i){var n=e.apply(t,a);function _next(e){asyncGeneratorStep(n,r,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(n,r,i,_next,_throw,"throw",e)}_next(void 0)})}}function ownKeys(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(a,!0).forEach(function(t){_defineProperty(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ownKeys(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const bt=[{labelKey:f.a.DAYS_ABBREVIATED,value:nt.g.DAYS},{labelKey:f.a.HOURS_ABBREVIATED,value:nt.g.HOURS},{labelKey:f.a.MINS_ABBREVIATED,value:nt.g.MINUTES}],gt={leverageInput:"",leverage:new k.a(2),slippageInput:"",slippage:le.d,stopSlippageInput:"",stopSlippage:le.e,error:null,loading:!1,didSetExpirationApproval:!1},Ot=_objectSpread({},gt,{goodTilDateInput:null,isTrailingStopOrder:!1});class yt extends c.Component{constructor(e){var t;super(e),t=this,this.componentDidUpdate=(e=>{const t=this.props,a=t.selectedTradeType,r=t.currentPair,i=t.currentTradeData,n=i.price,l=i.side,s=i.amount,c=t.setTradeData,d=this.state.leverage,p=e.currentPair,u=e.selectedTradeType;if(r.key!==p.key||r.type!==p.type)this.resetTradeBox();else if(a!==u)this.resetTradeBox({resetTradeData:!1});else{const e=this.getMarketPrice(l,s,d);o()(e,"baseAmount","").toString()!==o()(n,"baseAmount","").toString()&&c({price:this.getMarketPrice(l,s,d)})}}),this.resetTradeBox=(({resetTradeData:e=!0,resetIsTrailing:t=!0}={})=>{const a=this.props.setTradeData;e&&a(le.c);const r=_objectSpread({},gt);t&&(r.isTrailingStopOrder=!1),this.setState(r)}),this.getMarginAccountBalanceBN=(e=>{const t=this.props.marginAccount;if(!e)return null;const a=Object(rt.b)({account:t,market:e});return a?Object(z.a)(a.wei):null}),this.onClickCta=_asyncToGenerator(function*(){const e=t.props,a=e.allPairOrderData,r=e.baseMarket,i=e.canBypass28DayRequirement,n=e.currentPair,l=e.currentTradeData,s=l.amount,o=l.price,c=l.side,p=l.marginDeposit,u=l.tradeOrderType,m=l.triggerPriceMP,b=l.trailingPercent,g=e.legacySigning,O=e.marginAccount,y=e.openModal,E=e.placeCrossOrder,T=e.placeMarketIsolatedOrder,h=e.quoteMarket,P=e.selectedTradeType,R=e.stringGetter,S=e.walletAddress,I=e.walletType,M=n.type,D=t.state,_=D.leverage,A=D.slippage,L=D.isTrailingStopOrder;t.setState({loading:!0});const N=t.getIsolatedTradeAmount(s,_,c),j=function(){var e=_asyncToGenerator(function*(){try{if(P===le.v.CROSS){const e=t.getSoloLimitOrderData(),r=e.order,i=e.fillOrKill,l=e.postOnly,s=e.setExpirationOnFill,o=u===le.u.STOP;yield E({allPairOrderData:a,pair:n,walletType:I,legacySigning:g,order:r,fillOrKill:i,postOnly:l,setExpirationOnFill:s,isStopOrder:o,isTrailingStopOrder:o&&L,triggerPriceMP:(o||L)&&m,trailingPercent:o&&L&&(c===H.f.BUY?b:b.negated())})}else{const e=function getRandomHex(e){const t=ct.getRandomValues(new Uint8Array(e));let a="0x";for(let r=0;r<=t.length-1;r+=1){let e=t[r].toString(16);1===e.length&&(e=`0${e}`),a+=e}return a}(32),l=new k.a(e),d=o.getMarketPriceWithSlippage(A,c),u=Object(pt.a)({allPairOrderData:a,pair:n,baseMarket:r,quoteMarket:h,amount:N,side:c,priceMP:d,walletAddress:S,accountNumber:l,tradeOrderType:le.u.MARKET,isIsolatedOrder:!0}).order;yield T({order:u,marginDeposit:p,positionSize:s,leverage:_,liquidationPrice:t.getLiquidationPrice(),openPriceMP:d,side:c,baseMarket:r,quoteMarket:h,pair:n,accountNumberBN:l,walletAddress:S,walletType:I,legacySigning:g,setExpiration:!i})}t.resetTradeBox({resetIsTrailing:!1})}catch(e){let a;Object(mt.d)(e)?M===v.d.SPOT?(a=R({key:f.a.SPOT_LOW_COLL_TRY_POST_ONLY}),Object(dt.b)("trade-box","spot-collateralization-threshold-error")):(a=R({key:f.a.LOW_COLL_ORDER_TRY_AGAIN}),Object(dt.b)("trade-box","collateralization-threshold-error")):Object(mt.a)(e)?(a=R({key:f.a.PENDING_FILLS_TRY_AGAIN}),Object(dt.b)("trade-box","pending-fills-error")):Object(mt.f)(e)&&(a=R({key:f.a.SPOT_BALANCE_BELOW_ZERO}),Object(dt.b)("trade-box","spot-balance-below-zero-error"));const r=Object(mt.j)({error:e,walletAddress:S,walletType:I,location:"trade-box:place-order",notifyBugsnag:!a,stringGetter:R}).message;t.setState({loading:!1,error:a||r})}});return function executeOrder(){return e.apply(this,arguments)}}(),C=Object(z.a)(t.getPriceImpact()),x=C.abs().gt(le.r),w=t.getMarginAccountBalanceBN(r),q=t.getMarginAccountBalanceBN(h);let B=!1;P===le.v.ISOLATED&&(B=c===H.f.BUY?w.gte(0)&&w.minus(p.baseAmount).lt(0):q.gte(0)&&q.minus(p.baseAmount).lt(0));const U=Object(rt.c)({account:O,market:r}),G=Object(rt.c)({account:O,market:h});let W;P===le.v.ISOLATED&&(c===H.f.BUY&&w.lt(0)&&(U||i||(W=!0)),c===H.f.SELL&&q.lt(0)&&(G||i||(W=!0)));const F={onClickCta:j,onClickCancel:()=>t.setState({loading:!1}),onClickOutside:()=>t.setState({loading:!1})};if(B){let e="";i||(e=R({key:f.a.EXPIRATION_WARNING})),yield y({type:lt.a.WARNING,props:_objectSpread({title:R({key:f.a.NEGATIVE_BALANCE_WARNING_TITLE}),body:d.a.createElement("span",null,R({key:f.a.NEGATIVE_BALANCE_WARNING_BODY,params:{SYMBOL:c===H.f.BUY?r.symbol:h.symbol}})," ",e," ",R({key:f.a.WARNING_CONFIRM_TRADE})),ctaLabel:R({key:f.a.YES_CONTINUE})},F)})}else if(W){const e=c===H.f.BUY?r.symbol:h.symbol;yield y({type:lt.a.WARNING,props:_objectSpread({title:R({key:f.a.NEW_EXPIRY_WARNING_TITLE}),body:d.a.createElement("span",null,R({key:f.a.NEW_EXPIRY_WARNING_BODY,params:{SYMBOL:e}})," ",R({key:f.a.WARNING_CONFIRM_TRADE})),ctaLabel:R({key:f.a.YES_CONTINUE})},F)})}else x?yield y({type:lt.a.WARNING,props:_objectSpread({title:R({key:f.a.HIGH_PRICE_IMPACT_WARNING_TITLE}),body:d.a.createElement("span",null,R({key:f.a.HIGH_PRICE_IMPACT_WARNING_BODY,params:{PRICE_IMPACT:`${C.times(100).toFixed(2)}%`}})," ",R({key:f.a.WARNING_CONFIRM_TRADE})),ctaLabel:R({key:f.a.YES_CONTINUE})},F)}):yield j();t.setState({loading:!1})}),this.setDydexExpirationApproval=_asyncToGenerator(function*(){const e=t.props,a=e.setExpiryApproval,r=e.stringGetter,i=e.walletAddress,n=e.walletType;t.setState({loading:!0,didSetExpirationApproval:!0});try{yield a({walletAddress:i})}catch(l){const e=Object(mt.j)({error:l,walletAddress:i,walletType:n,location:"trade-box:set-approval",stringGetter:r}).message;t.setState({loading:!1,error:e,didSetExpirationApproval:!1})}t.setState({loading:!1})}),this.getSoloLimitOrderData=(()=>{const e=this.props,t=e.allPairOrderData,a=e.baseMarket,r=e.canBypass28DayRequirement,i=e.currentPair,n=e.currentTradeData,l=n.amount,s=n.price,o=n.side,c=n.tradeOrderType,d=n.limitPrice,p=n.triggerPriceMP,u=n.postOnlyChecked,m=n.timeInForceOption,b=n.trailingPercent,g=e.selectedTradeType,O=e.quoteMarket,y=e.spotAccount,E=e.walletAddress,T=this.state,h=T.leverage,P=T.slippage,f=T.stopSlippage,R=T.goodTilDateInput,S=T.goodTilDateTimescale,I=T.isTrailingStopOrder;if(!l||l.lt(0)||c===le.u.LIMIT&&!d||c===le.u.MARKET&&!s||c===le.u.STOP&&(I?!b||b.isZero():!p))return{};const M=i.type;let D;if(c===le.u.LIMIT)D=d;else if(c===le.u.MARKET){const e=s.getMarketPriceWithSlippage(P,o);if(M===v.d.SPOT&&o===H.f.BUY){const t=ot.a.canonicalOrders.getFeeForOrder(Object(z.a)(a.id),l),r=Object(z.a)(Object(rt.b)({account:y,market:O}).wei).div(l.times(t.plus(1)));D=new ce.a(k.a.min(r,e.baseAmount),a,O)}else D=e}else c===le.u.STOP&&(D=p.getMarketPriceWithSlippage(f,o));const _=g===le.v.ISOLATED,A=Object(pt.a)({allPairOrderData:t,pair:i,baseMarket:a,quoteMarket:O,amount:_?this.getIsolatedTradeAmount(l,h,o):l,side:o,priceMP:D,triggerPriceMP:p,walletAddress:E,tradeOrderType:c,goodTilDate:new k.a(Object(pt.d)(R,S.value).toSeconds()).integerValue(k.a.ROUND_CEIL),timeInForceOption:m,postOnly:u,decreaseOnly:!1,isTrailingStopOrder:I,isIsolatedOrder:_});return{order:A.order,fillOrKill:A.fillOrKill,postOnly:A.postOnly,setExpirationOnFill:!r}}),this.onChangeCustomLeverage=(e=>{const t=this.props.currentTradeData.side,a=e.slice(0,-1);this.setState({leverageInput:a}),Object(dt.b)("trade-box","change-custom-leverage-button",{leverage:a}),(t===H.f.SELL&&a>0&&a<=4||t===H.f.BUY&&a>1&&a<=5)&&this.updateOrder({leverage:new k.a(e.slice(0,-1))})}),this.onUpdateLeverage=(e=>{this.setState({leverageInput:""}),Object(dt.b)("trade-box","click-leverage-button",{leverage:e}),this.updateOrder({leverage:new k.a(e)})}),this.onUpdateAmountInput=((e,t)=>{const a=this.state.leverage;this.updateOrder({newAmount:e,newAmountDisplayValue:t,leverage:a})}),this.onUpdateLimitPriceInput=((e,t)=>{const a=this.props,r=a.allPairOrderData,i=a.currentPair.orderMarket,n=a.setTradeData,l=a.baseMarket,s=a.quoteMarket,o=a.currentTradeData.tradeOrderType,c=(r[i]||{}).minimumTickSize,d=H.a.ONE.shiftedBy(l.currency.decimals);let p=o;t&&(p=le.u.LIMIT),n({tradeOrderType:p,limitPrice:t?new ce.a(e.div(d),l,s).getMarketPriceRoundedToTickSize(c):null}),this.setState({error:null})}),this.onUpdateStopPriceInput=((e,t)=>{const a=this.props,r=a.allPairOrderData,i=a.currentPair.orderMarket,n=a.setTradeData,l=a.baseMarket,s=a.quoteMarket,o=(r[i]||{}).minimumTickSize,c=H.a.ONE.shiftedBy(l.currency.decimals);n({triggerPriceMP:t?new ce.a(e.div(c),l,s).getMarketPriceRoundedToTickSize(o):null}),this.setState({error:null})}),this.onUpdateTrailingPercentInput=(e=>{const t=this.props,a=t.allIndexPrices,r=t.allMarkets,i=t.baseMarket,n=t.currentPair,l=t.currentTradeData.side,s=t.quoteMarket,o=t.setTradeData;let c=null;if(e&&!e.isZero()){const t=Object(G.a)({pair:n,allIndexPrices:a,allMarkets:r});c=ce.a.fromNaturalValue(Object(z.a)(t).times(l===H.f.BUY?H.a.ONE.plus(e.shiftedBy(-2)):H.a.ONE.minus(e.shiftedBy(-2))),i,s)}o({trailingPercent:e,triggerPriceMP:c}),this.setState({error:null})}),this.onUpdateGoodTilDate=((e,t)=>{let a=parseInt(e,10);a>nt.e&&(a=nt.e),this.setState({error:null,goodTilDateInput:a,goodTilDateTimescale:t})}),this.onClickMax=(()=>{const e=this.props,t=e.allMarkets,a=e.allOrderbookOrders,r=e.currentPair,i=e.baseMarket,n=e.quoteMarket,l=e.currentTradeData.side,s=e.selectedTradeType,o=this.state.leverage,c=this.getMarginAccountBalanceBN(i),d=this.getMarginAccountBalanceBN(n);if(i&&n&&c&&d&&s===le.v.ISOLATED){const e=Object(de.c)({allMarkets:t,allOrderbookOrders:a,currentPair:r,baseMarket:i,quoteMarket:n,side:l,leverage:o,baseMarketBalanceBN:c,quoteMarketBalanceBN:d,collateralization:this.getCollateralization(o,l)});if(e){const t=e.amount,a=e.amountNatural;this.updateOrder({newAmount:t,newAmountDisplayValue:a,leverage:o})}}}),this.onClickBuy=(()=>{const e=this.props.selectedTradeType,t=this.state.leverage;let a=t;e!==le.v.ISOLATED||!t.lte(1)&&this.getIsLeverageValid()||(a=new k.a(2),this.setState({leverageInput:""})),Object(dt.b)("trade-box","click-long"),this.updateOrder({newSide:H.f.BUY,leverage:a})}),this.onClickSell=(()=>{const e=this.state.leverage;let t=e;!e.gte(3)&&this.getIsLeverageValid()||(t=new k.a(3),this.setState({leverageInput:""})),Object(dt.b)("trade-box","click-short"),this.updateOrder({newSide:H.f.SELL,leverage:t})}),this.updateOrder=(({newAmount:e,newAmountDisplayValue:t,newSide:a,leverage:r})=>{const i=this.props,n=i.baseMarket,s=i.currentTradeData,o=s.amount,c=s.side,d=i.quoteMarket,p=i.selectedTradeType,u=i.setTradeData,m=this.state.amountDisplayValue,b=e||o,g=a||c,O=this.getMarketPrice(g,b,r);if(p===le.v.CROSS)return u({amount:b,amountDisplayValue:l()(t)?m:t,side:g,price:O,selectedPerpetualLeverage:null}),void this.setState({error:null,leverage:r});const y=g===H.f.SELL?d:n;let k=null;O&&b.gt(H.a.ZERO)&&(k=Object(de.b)({positionCollateralization:this.getCollateralization(r,g),tradeAmount:this.getIsolatedTradeAmount(b,r,g),orderSide:g,orderAmount:b,price:O,marginDepositMarket:y,quoteMarket:d})),u({amount:b,amountDisplayValue:l()(t)?m:t,side:g,price:O,marginDeposit:k,marginDepositMarket:y}),this.setState({error:null,leverage:r})}),this.getIsLeverageValid=(()=>{const e=this.state,t=e.leverageInput,a=e.leverage;return!(""!==t&&!new k.a(t).eq(a))}),this.renderSubmitButton=(e=>{const t=this.props,a=t.areDydexOrdersEnabled,r=t.canBypass28DayRequirement,n=t.currentPair.type,l=t.currentTradeData,s=l.amount,o=l.side,c=l.tradeOrderType,p=l.limitPrice,u=l.triggerPriceMP,m=l.trailingPercent,b=t.isPairOrderDataLoaded,g=t.isUserInUsa,O=t.isWalletReady,y=t.selectedTradeType,k=t.stringGetter,E=t.walletAddress,T=this.state,h=T.loading,P=T.didSetExpirationApproval,R=T.isTrailingStopOrder,S=n===v.d.PERPETUAL,I=n===v.d.MARGIN;let M,D,_=!1;I&&O&&(!1!==a||r||(_=!0));const A=S&&g&&!Object(K.d)(E);A?(M=i.a,D=k({key:f.a.UNAVAILABLE})):_?(M=this.setDydexExpirationApproval,D=k({key:f.a.ENABLE_DYDX_ORDERS})):(M=this.onClickCta,y===le.v.ISOLATED?D=o===H.f.BUY?k({key:f.a.OPEN_LONG_POSITION}):k({key:f.a.OPEN_SHORT_POSITION}):c===le.u.MARKET?D=k({key:f.a.PLACE_MARKET_ORDER}):c===le.u.LIMIT?D=k({key:f.a.PLACE_LIMIT_ORDER}):c===le.u.STOP&&(D=k({key:f.a.PLACE_STOP_ORDER})));const L=g&&I&&O&&null===a,N=P&&!a,j=!!e||!s||s.eq(H.a.ZERO)||c===le.u.LIMIT&&(!p||p.baseAmount.isZero())||c===le.u.STOP&&(R?!m||m.isZero():!u)||!this.getIsLeverageValid(),C=!O||!_&&j||S&&A;return d.a.createElement(Ce.c,{className:"cta-button",onClick:M,disabled:!st.a.enablealways&&(C||L||!b),green:o===H.f.BUY,red:o===H.f.SELL,loading:h||L||N||!b},D)}),this.getError=(()=>{const e=this.props,t=e.allIndexPrices,a=e.allMarkets,r=e.allOrderbookOrders,i=e.allOrders,n=e.allPairOrderData,l=e.baseMarket,s=e.currentPair,o=e.currentTradeData,c=e.marginAccount,d=e.perpetualBalances,p=e.perpetualMarkets,u=e.quoteMarket,m=e.selectedTradeType,b=e.spotAccount,g=e.stringGetter,O=this.state,y=O.leverage,k=O.goodTilDateInput,E=O.goodTilDateTimescale,T=o.side,h=o.amount;return Object(mt.i)({account:s.type===v.d.SPOT?b:c,allIndexPrices:t,allMarkets:a,allOrders:i,allPairOrderData:n,baseMarket:l,currentPair:s,currentTradeData:o,goodTilDateInput:k,goodTilDateTimescale:E,oraclePriceNatural:Object(U.a)({allMarkets:a,perpetualMarkets:p,pair:s}),perpetualBalances:d,perpetualMarkets:p,quoteMarket:u,selectedTradeType:m,soloLimitOrderData:this.getSoloLimitOrderData(),stringGetter:g,tradeAmount:m===le.v.CROSS?h:this.getIsolatedTradeAmount(h,y,T),worstPrice:Object(F.b)({allOrderbookOrders:r,allMarkets:a,pair:s,side:T,amount:h})})});const a=e.stringGetter;this.state=_objectSpread({},Ot,{goodTilDateTimescale:{label:a({key:bt[0].labelKey}),value:bt[0].value}})}getIsolatedTradeAmount(e,t,a){return a===H.f.SELL?e:e.times(H.a.ONE.minus(H.a.ONE.div(t)))}getCollateralization(e,t){if(t===H.f.SELL){if(e.lte(H.a.ZERO))throw new Error(`Leverage <= 0 : ${e.toFixed()}`);return e.plus(1).div(e)}if(e.lte(1))throw new Error(`Leverage <= 1 : ${e.toFixed()}`);return e.div(e.minus(1))}getMarketPrice(e,t,a){const r=this.props,i=r.allOrderbookOrders,n=r.allMarkets,l=r.currentPair;let s=t;return r.selectedTradeType===le.v.ISOLATED&&(s=this.getIsolatedTradeAmount(t,a,e)),Object(F.a)({allOrderbookOrders:i,allMarkets:n,pair:l,side:e,amount:s})}getPriceImpact(){const e=this.props,t=e.currentPair,a=e.allOrderbookOrders,r=e.currentTradeData,i=r.price,n=r.side,l=r.amount,s=r.tradeOrderType,o=Object(F.c)({allOrderbookOrders:a,pair:t,side:n});let c;return s===le.u.MARKET&&o&&l.gt(H.a.ZERO)&&i&&(c=new k.a(i.baseAmount).minus(o).div(o)),c}getLiquidationPrice(){const e=this.props,t=e.baseMarket,a=e.quoteMarket,r=e.selectedTradeType,i=e.currentTradeData,n=i.price,l=i.side,s=i.amount,o=i.marginDeposit;let c;if(!n||!s.gt(H.a.ZERO))return c;const d=Object(de.a)({tradeType:r,price:n,side:l,amount:s,marginDepositMV:o}),p=d.debtWei,u=d.collateralWei;if(r===le.v.ISOLATED){let e;l===H.f.BUY?e=p.times(le.k).div(u).abs():l===H.f.SELL&&(e=u.div(le.k).div(p).abs()),c=new ce.a(e,t,a)}return c}renderInputs(){const e=this.props,t=e.currentPair,a=t.type,r=t.displayQuoteSymbol,i=t.tickDecimals,n=t.isInversePerpetual,l=e.baseMarket,s=e.quoteMarket,o=e.currentTradeData,p=o.amount,u=o.amountDisplayValue,m=o.side,b=o.tradeOrderType,g=o.limitPrice,O=o.triggerPriceMP,y=o.trailingPercent,E=e.selectedTradeType,T=e.setTradeData,h=e.stringGetter,P=this.state,R=P.leverage,S=P.isTrailingStopOrder,I=this.getMarketPrice(m,p.gt(0)?p:new k.a(.1),R),M=I?`~${I.getNaturalValue().toFixed(i)}`:"-",D=a===v.d.PERPETUAL,_=E===le.v.ISOLATED,A=E===le.v.CROSS,L=b===le.u.MARKET,N=b===le.u.LIMIT,j=b===le.u.STOP,C=[{key:le.u.MARKET,label:h({key:f.a.ORDER_TYPES_MARKET})},{key:le.u.LIMIT,label:h({key:f.a.ORDER_TYPES_LIMIT})},{key:le.u.STOP,label:h({key:f.a.ORDER_TYPES_STOP})}];let q;q=_?"position-size":m===H.f.BUY?"amount-buy":"amount-sell";const B=D?N:A&&!j;return d.a.createElement(c.Fragment,null,A&&d.a.createElement(je,{className:"order-type-tabs",tabConfig:C,selectedTabKey:b,onClick:e=>{this.setState({isTrailingStopOrder:!1}),T({tradeOrderType:e,limitPrice:null,triggerPriceMP:null,trailingPercent:null})}}),j&&d.a.createElement(ke.a,{className:"toggle",leftLabel:h({key:f.a.STANDARD}),rightLabel:d.a.createElement("div",{className:"trailing-stop-toggle"},d.a.createElement("div",{className:"trailing-label"},h({key:f.a.TRAILING_STOP_ABBREVIATED}),d.a.createElement(x.a,{shortDelay:!0,className:"help-icon",top:12,left:-228,tooltip:"trailing-stop"},"?"))),onClickLeft:()=>{this.setState({isTrailingStopOrder:!1}),T({triggerPriceMP:null,trailingPercent:null})},onClickRight:()=>{this.setState({isTrailingStopOrder:!0}),T({triggerPriceMP:null,trailingPercent:null})},isToggledRight:S,grayscale:!0,compact:!0}),d.a.createElement(w.c,{label:d.a.createElement(x.a,{top:8,left:-48,tooltip:q,stringParams:{SYMBOL:l.symbol}},h(_?{key:f.a.POSITION_SIZE}:{key:f.a.AMOUNT}))},d.a.createElement(Ue.b,{autoFillZero:!0,value:u,market:n?_objectSpread({},s,{symbol:r}):l,onChange:this.onUpdateAmountInput,onClickMax:_?this.onClickMax:null})),B&&d.a.createElement(w.c,{label:h({key:f.a.PRICE})},d.a.createElement(Ue.b,{value:g&&g.getNaturalValue().toFixed(i),market:_objectSpread({},s,{symbol:r}),whitePlaceholder:b===le.u.MARKET,placeholder:b===le.u.MARKET?M:h({key:f.a.ENTER_PRICE}),onChange:this.onUpdateLimitPriceInput})),D&&L&&d.a.createElement(c.Fragment,null,d.a.createElement("div",{className:"perpetual-slider-divider"},d.a.createElement("div",{className:"perpetual-slider-divider__line"}),d.a.createElement("div",{className:"perpetual-slider-divider__text"},h({key:f.a.OR})),d.a.createElement("div",{className:"perpetual-slider-divider__line"})),d.a.createElement(ae,null)),j&&(S?d.a.createElement(w.c,{label:d.a.createElement(x.a,{top:8,left:-48,tooltip:"trailing-stop"},h({key:f.a.TRAILING_PERCENT}))},d.a.createElement(Ue.b,{suffix:"%",value:y?y.toFixed(Y.k):"",placeholder:h({key:f.a.ENTER_PERCENT}),onChange:this.onUpdateTrailingPercentInput})):d.a.createElement(w.c,{label:d.a.createElement(x.a,{top:8,left:-48,tooltip:"stop-price",stringParams:{SYMBOL:l.symbol}},h({key:f.a.STOP_PRICE}))},d.a.createElement(Ue.b,{value:O&&O.getNaturalValue().toFixed(i),market:_objectSpread({},s,{symbol:r}),placeholder:h({key:f.a.ENTER_PRICE}),onChange:this.onUpdateStopPriceInput}))),_&&this.renderLeverageGrid())}renderLeverageGrid(){const e=this.props,t=e.currentTradeData.side,a=e.stringGetter,r=this.state,i=r.leverage,n=r.leverageInput,l=""!==n;return d.a.createElement(w.c,{label:d.a.createElement(x.a,{top:6,left:-48,tooltip:"leverage"},a({key:f.a.LEVERAGE}))},d.a.createElement("div",{className:"leverage-grid"},d.a.createElement(Ce.g,{type:Ce.a.SECONDARY,disabled:t===H.f.BUY,selected:!l&&i.eq(1),onClick:()=>this.onUpdateLeverage(1)},"1x"),d.a.createElement(Ce.g,{type:Ce.a.SECONDARY,selected:!l&&i.eq(2),onClick:()=>this.onUpdateLeverage(2)},"2x"),d.a.createElement(Ce.g,{type:Ce.a.SECONDARY,selected:!l&&i.eq(3),onClick:()=>this.onUpdateLeverage(3)},"3x"),d.a.createElement(Ce.g,{type:Ce.a.SECONDARY,selected:!l&&i.eq(4),onClick:()=>this.onUpdateLeverage(4)},"4x"),d.a.createElement(Ce.g,{type:Ce.a.SECONDARY,disabled:t===H.f.SELL,selected:!l&&i.eq(5),onClick:()=>this.onUpdateLeverage(5)},"5x"),d.a.createElement(Ce.h,{type:Ce.a.SECONDARY,onChange:this.onChangeCustomLeverage,placeholder:a({key:f.a.CUSTOM_INPUT}),selected:l,max:t===H.f.SELL?4:5,value:n,suffix:"X"})))}renderSlippageGrid(){let e,t,a,r,i;this.props.currentTradeData.tradeOrderType===le.u.STOP?(e="stopSlippage",t="stopSlippageInput",a=le.e,r=le.o,i=[{value:.02,label:"2.0%"},{value:.05,label:"5.0%"}]):(e="slippage",t="slippageInput",a=le.d,r=le.l,i=[{value:.005,label:"0.5%"},{value:.01,label:"1.0%"}]);const n=this.state,l=n[e],s=n[t];return d.a.createElement(Be,{slippage:l,slippageInput:s,buttonConfig:i,onClickButton:a=>this.setState({[e]:new k.a(a),[t]:""}),onChangeInput:r=>this.setState({[e]:r?new k.a(r).div(100):a,[t]:r}),maxSlippage:r.times(100).toNumber()})}getTimeInForceConfig(){const e=this.props.stringGetter;return[{key:nt.p.GOOD_TIL,label:d.a.createElement("div",{className:"time-in-force-option"},d.a.createElement(He,null),e({key:f.a.GOOD_TIL_DATE_ABBREVIATED}))},{key:nt.p.FILL_OR_KILL,label:d.a.createElement("div",{className:"time-in-force-option"},d.a.createElement(Je,null),e({key:f.a.FILL_OR_KILL}))}]}renderGoodTilDate(){const e=this.props.stringGetter,t=this.state,a=t.goodTilDateInput,r=t.goodTilDateTimescale;return d.a.createElement(w.c,{label:d.a.createElement(x.a,{top:8,left:-48,tooltip:"good-til-date"},e({key:f.a.GOOD_TIL_DATE}))},d.a.createElement(Ue.c,{inputValue:a,dropdownValue:r,placeholder:H.b,onChange:this.onUpdateGoodTilDate,dropdownConfig:bt.map(t=>{let a=t.labelKey;return _objectSpread({},trade_box_objectWithoutProperties(t,["labelKey"]),{label:e({key:a})})}),max:1e3}))}renderLimitOrderOptions(){const e=this.props,t=e.currentTradeData,a=t.postOnlyChecked,r=t.timeInForceOption,i=e.setTradeData,n=e.stringGetter;return d.a.createElement(c.Fragment,null,d.a.createElement(w.c,{label:d.a.createElement(x.a,{top:8,left:-48,tooltip:"time-in-force"},n({key:f.a.TIME_IN_FORCE}))},d.a.createElement(Te.b,{compact:!0,selectedItemKey:r,onChangeSelection:e=>i({timeInForceOption:e}),menuItems:this.getTimeInForceConfig()})),r===nt.p.GOOD_TIL&&d.a.createElement(c.Fragment,null,this.renderGoodTilDate(),d.a.createElement(w.c,{label:n({key:f.a.TRADE_EXECUTION})},d.a.createElement(Ee.a,{className:"post-only-checkbox",checked:a,label:d.a.createElement(c.Fragment,null,d.a.createElement("div",{className:"post-only-checkbox__label"},n({key:f.a.POST_ONLY}),d.a.createElement(x.a,{className:"post-only-checkbox__tooltip",top:8,left:-144,tooltip:"post-only"},"?"))),onClick:()=>i({postOnlyChecked:!a})}))))}renderAdvancedOptions(){const e=this.props,t=e.baseMarket,a=e.currentPair.type,r=e.currentTradeData,i=r.tradeOrderType,n=r.newBaseMarketAccountBalance,l=r.newQuoteMarketAccountBalance,s=e.quoteMarket,o=e.selectedTradeType,p=e.stringGetter,u=this.state.isTrailingStopOrder;let m;switch(i){case le.u.MARKET:m=this.renderSlippageGrid();break;case le.u.LIMIT:m=this.renderLimitOrderOptions();break;case le.u.STOP:m=d.a.createElement(c.Fragment,null,this.renderGoodTilDate(),this.renderSlippageGrid());break;default:m=d.a.createElement("div",null)}const b=this.getMarginAccountBalanceBN(t),g=this.getMarginAccountBalanceBN(s),O=a===v.d.MARGIN;let y;o===le.v.CROSS&&O&&(y={label:p({key:f.a.MARGIN}),isActive:b.lt(0)||g.lt(0)||n&&n.lt(0)||l&&l.lt(0)});const k=Object(ut.b)(ut.a.HIDE_MARGIN_TRADING_INFO)||!O;return d.a.createElement(ve,{label:p({key:f.a.ADVANCED_OPTIONS}),badge:y,onClick:()=>Object(dt.b)("trade-box","toggle-advanced-options",{selectedTradeType:o,tradeOrderType:i,isTrailingStopOrder:u})},m,o===le.v.CROSS&&!k&&d.a.createElement(w.c,{label:d.a.createElement("div",{className:"margin-trading-info"},p({key:f.a.MARGIN_TRADING}),d.a.createElement("div",{role:"button",tabIndex:0,className:"dismiss-button",onClick:()=>{Object(ut.d)(ut.a.HIDE_MARGIN_TRADING_INFO,!0)}},p({key:f.a.DISMISS})))},d.a.createElement("div",{className:"info-subsection"},p({key:f.a.MARGIN_TRADING_DESCRIPTION}))))}renderReceipt(){const e=this.props,t=e.currentTradeData,a=t.side,r=t.amount,i=e.selectedTradeType,n=this.state,l=n.leverage,s=n.slippage,o=n.stopSlippage,c=i===le.v.CROSS?r:this.getIsolatedTradeAmount(r,l,a);return d.a.createElement(ye,{priceImpact:this.getPriceImpact(),tradeAmount:c,isLeverageValid:this.getIsLeverageValid(),liquidationPrice:this.getLiquidationPrice(),slippage:s,stopSlippage:o})}render(){const e=this.props,t=e.currentPair.type,a=e.currentTradeData.side,r=e.selectedTradeType,i=e.stringGetter,n=e.walletAddress,l=this.state.error;let s=i({key:f.a.LONG}),o=i({key:f.a.SHORT});r===le.v.CROSS&&(s=i({key:f.a.BUY}),o=i({key:f.a.SELL}));const c=l||this.getError();return d.a.createElement("div",{className:O()("component-trade-box",{"component-trade-box__top-border-radius":t!==v.d.MARGIN})},d.a.createElement("div",{className:"order-section"},!Object(K.d)(n)&&d.a.createElement(M,null),d.a.createElement(ke.a,{className:"toggle",leftLabel:s,rightLabel:o,onClickLeft:this.onClickBuy,onClickRight:this.onClickSell,isToggledRight:a===H.f.SELL}),this.renderInputs(),this.renderAdvancedOptions(),this.renderReceipt(),this.renderSubmitButton(c)),d.a.createElement("div",{className:"error-section"},c?d.a.createElement(Ge.c,null,c):null))}}yt.propTypes={allIndexPrices:u.a.object.isRequired,allMarkets:u.a.array.isRequired,allOrderbookOrders:u.a.object.isRequired,allOrders:u.a.array.isRequired,allPairOrderData:u.a.object.isRequired,areDydexOrdersEnabled:u.a.bool,baseMarket:u.a.object.isRequired,canBypass28DayRequirement:u.a.bool.isRequired,currentPair:u.a.object.isRequired,currentTradeData:u.a.object.isRequired,isPairOrderDataLoaded:u.a.bool.isRequired,isUserInUsa:u.a.bool.isRequired,isWalletReady:u.a.bool.isRequired,legacySigning:u.a.bool,marginAccount:u.a.object,openModal:u.a.func.isRequired,perpetualBalances:u.a.object.isRequired,perpetualMarkets:u.a.object.isRequired,placeCrossOrder:u.a.func.isRequired,placeMarketIsolatedOrder:u.a.func.isRequired,quoteMarket:u.a.object.isRequired,selectedTradeType:u.a.string.isRequired,setExpiryApproval:u.a.func.isRequired,setTradeData:u.a.func.isRequired,spotAccount:u.a.object,stringGetter:u.a.func.isRequired,walletAddress:u.a.string,walletType:u.a.string};var kt=Object(E.k)(Object(m.c)(e=>({allIndexPrices:Object(G.b)(e),allMarkets:Object(U.d)(e),allOrderbookOrders:Object(F.d)(e),allOrders:Object(it.k)(e),allPairOrderData:Object(P.c)(e),areDydexOrdersEnabled:Object(it.f)(e),baseMarket:Object(P.d)(e),canBypass28DayRequirement:Object(h.a)(e),currentPair:Object(P.e)(e),currentTradeData:Object(W.b)(e),isPairOrderDataLoaded:Object(P.f)(e),isUserInUsa:Object(h.c)(e),isWalletReady:Object(ne.w)(e),legacySigning:Object(ne.i)(e),marginAccount:Object(rt.r)(e),perpetualBalances:Object(B.e)(e),perpetualMarkets:Object(B.g)(e),quoteMarket:Object(P.h)(e),selectedTradeType:Object(W.f)(e),spotAccount:Object(rt.v)(e),walletAddress:Object(ne.m)(e),walletType:Object(ne.q)(e)}),e=>Object(b.b)({placeMarketIsolatedOrder:et.d,openModal:at.c,setExpiryApproval:tt.d,setTradeData:q.e,placeCrossOrder:et.c},e))(yt));a.d(t,"a",function(){return kt})},2173:function(e,t,a){"use strict";var r=a(0),i=a.n(r),n=a(1),l=a.n(n),s=a(52),o=a(19),c=a.n(o),d=a(2128),p=a(55),u=a.n(p),m=a(148),b=a(31),g=a(44),O=a(2137),y=a(24),k=a(61),E=a(2),T=a(10),h=a(2163),P=a.n(h);const f=({currentPair:{key:e,type:t},marketStats:a,onClick:r})=>{let n;return t===y.d.SPOT?n=y.g:t===y.d.MARGIN?n=y.e:t===y.d.PERPETUAL&&(n=y.f),i.a.createElement("div",{className:P.a.dropdown},u()(n,n=>{const l=n.key,s=n.path,o=n.marketName,p=n.baseSymbol,u=n.quoteSymbol,g=n.tickDecimals,h=Object(O.b)({allMarketStats:a,pair:n}),f=h&&h.open&&h.last&&"0"!==h.open?Object(T.a)(h.last).minus(h.open).div(h.open).times(100):E.a.ZERO;return i.a.createElement(m.a,{key:l,to:s,onClick:r},i.a.createElement("div",{className:P.a.pairEntry},i.a.createElement("div",{className:P.a.marketNameIcon},i.a.createElement("div",{className:c()(P.a.marketIcon,{[P.a.marketIconPerp]:t===y.d.PERPETUAL})},i.a.createElement(d.a,{symbol:p})),o),i.a.createElement("div",{className:P.a.priceContainer},h&&h.last&&`${Object(T.a)(h.last).toFixed(g)} ${u}`),i.a.createElement("div",{className:P.a.changeContainer},f?i.a.createElement("div",{className:c()(P.a.percentChange,{[P.a.green]:f.gte(0),[P.a.red]:f.lt(0)})},`${f.gte(0)?"+":""}${f.toFixed(k.k)}%`):i.a.createElement("div",null),e===l?i.a.createElement("div",{className:P.a.selectedEntryCheck},i.a.createElement(b.p,null)):i.a.createElement("div",null))))}))};f.propTypes={currentPair:l.a.object.isRequired,marketStats:l.a.array,onClick:l.a.func};var v=Object(s.c)(e=>({currentPair:Object(g.e)(e),marketStats:Object(O.i)(e)}))(f),R=a(2164),S=a.n(R);class I extends r.Component{constructor(e){super(e),this.onClickOutside=(e=>{this.marketDropdownRef.current.contains(e.target)||this.setState({showMarketDropdown:!1})}),this.toggleMarketDropdown=(()=>this.setState(({showMarketDropdown:e})=>({showMarketDropdown:!e}))),this.state={showMarketDropdown:!1},this.marketDropdownRef=Object(r.createRef)()}componentWillMount(){window.addEventListener("click",this.onClickOutside)}componentWillUnmount(){window.removeEventListener("click",this.onClickOutside)}render(){const e=this.props.currentPair,t=e.key,a=e.type,r=this.state.showMarketDropdown,n=y.b[t],l=n.baseSymbol,s=n.displayQuoteSymbol;return i.a.createElement("div",{className:S.a.selectMarket},i.a.createElement("div",{className:S.a.selectMarketButtonDropdown},i.a.createElement("div",{role:"button",tabIndex:0,className:c()(S.a.selectMarketButton,{[S.a.buttonDropdownOpen]:r}),ref:this.marketDropdownRef,onClick:this.toggleMarketDropdown},l,i.a.createElement("div",{className:c()(S.a.marketIcon,{[S.a.marketIconPerp]:a===y.d.PERPETUAL})},i.a.createElement(d.a,{symbol:l})),s),r&&i.a.createElement(v,null)))}}I.propTypes={currentPair:l.a.object.isRequired};var M=Object(s.c)(e=>({currentPair:Object(g.e)(e)}))(I);a.d(t,"a",function(){return M})},2216:function(e,t,a){"use strict";a.r(t);var r=a(231),i=a.n(r),n=a(37),l=a.n(n),s=a(0),o=a.n(s),c=a(1),d=a.n(c),p=a(52),u=a(60),m=a(230),b=a.n(m),g=a(19),O=a.n(g),y=a(74),k=a(2132),E=a(2173),T=a(2152),h=a(2172),P=a(2123),f=a(2138),v=a(617),R=a(190),S=a(45),I=a(44),M=a(250),D=a(33),_=a(26),A=a(616),L=a(296),N=a(2122),j=a(5),C=a(298),x=a(388),w=a(191),q=a(615),B=a(2251),U=a.n(B);class G extends s.Component{constructor(...e){super(...e),this.renderBalancesRow=(({key:e,name:t,beforeString:a,afterString:r,arrowColor:i,isLoading:n})=>o.a.createElement("div",{key:e,className:O()(U.a.balanceItem,{[U.a.balanceItemHighlight]:i})},o.a.createElement("div",null,t),o.a.createElement("div",{className:O()({[U.a.balanceLoading]:n})},o.a.createElement(v.a,{narrowContainer:!0,afterText:i&&r,arrow:i},a))))}renderPerpBalances(){const e=this.props,t=e.allIndexPrices,a=e.allMarkets,r=e.currentPair,n=e.isUserInUsa,s=e.openSidebarModal,c=e.pendingDepositsWithdrawals,d=e.perpetualBalances,p=e.stringGetter,u=e.walletAddress,m=r.marketName,g=r.orderMarket,O=r.settlementSymbol,y=r.displaySettlementSymbol,E=r.maxLeverage,T=r.isInversePerpetual,h=Object(_.c)({allMarkets:a,symbol:O}),v=t[g],S=d[g];if(!S||!v)return null;const I=Object(q.a)({balances:S,indexPrice:v,maxLeverage:E,isInversePerpetual:T}),M=I.equity,D=I.freeCollateral,A=S.pendingMargin,L=S.pendingPosition,N="0"!==A||"0"!==L||!!l()(c,({orderMarket:e})=>e===g),B=!M.isZero(),G=n&&!Object(q.d)(u);return o.a.createElement("div",{className:U.a.sidebarBalances},o.a.createElement("div",{className:U.a.sidebarBalancesContent},o.a.createElement("div",{className:U.a.title},o.a.createElement(P.a,{top:16,left:-32,tooltip:"perpetual-account",stringParams:{MARKET:m}},m," ",p({key:j.a.PERPETUAL_CONTRACT_SHORT})),N&&o.a.createElement(k.b,null)),this.renderBalancesRow({key:"equity",name:o.a.createElement(P.a,{className:U.a.tooltipWithTag,top:16,left:-32,tooltip:"perpetual-equity"},o.a.createElement(f.a,{tag:y},p({key:j.a.EQUITY}))),beforeString:o.a.createElement(b.a,{thousandSeparator:!0,displayType:"text",value:`${Object(w.e)(M,h.currency.decimals)} ${h.symbol}`}),isLoading:N}),this.renderBalancesRow({key:"free collateral",name:o.a.createElement(P.a,{className:U.a.tooltipWithTag,top:16,left:-32,tooltip:"perpetual-free-collateral"},o.a.createElement(f.a,{tag:y},p({key:j.a.FREE_COLLATERAL}))),beforeString:o.a.createElement(b.a,{thousandSeparator:!0,displayType:"text",value:`${Object(w.e)(D,h.currency.decimals)} ${h.symbol}`}),isLoading:N}),o.a.createElement("div",{className:U.a.buttons},o.a.createElement(R.g,{type:B||G?R.a.SECONDARY:R.a.PRIMARY,blue:!B&&!G,disabled:G,onClick:G?i.a:()=>s({modalType:C.a.DEPOSIT,modalProps:{product:x.a.PERPETUALS}})},p({key:j.a.DEPOSIT})),o.a.createElement(R.g,{type:R.a.SECONDARY,disabled:!B,onClick:()=>s({modalType:C.a.WITHDRAW})},p({key:j.a.WITHDRAW})))))}render(){const e=this.props,t=e.isWalletReady,a=e.arePerpBalancesLoaded,r=e.areIndexPricesLoaded;return o.a.createElement("div",{className:U.a.perpSidebar},o.a.createElement(E.a,null),t&&a&&r?this.renderPerpBalances():o.a.createElement(T.a,{isPerpPage:!0}),o.a.createElement("div",{className:U.a.scrollContainer},o.a.createElement(h.a,null)))}}G.propTypes={allIndexPrices:d.a.object.isRequired,allMarkets:d.a.array.isRequired,areIndexPricesLoaded:d.a.bool.isRequired,arePerpBalancesLoaded:d.a.bool.isRequired,currentPair:d.a.object.isRequired,isUserInUsa:d.a.bool.isRequired,isWalletReady:d.a.bool.isRequired,openSidebarModal:d.a.func.isRequired,pendingDepositsWithdrawals:d.a.array.isRequired,perpetualBalances:d.a.object.isRequired,stringGetter:d.a.func.isRequired,walletAddress:d.a.string};t.default=Object(y.k)(Object(p.c)(e=>({allIndexPrices:Object(N.b)(e),allMarkets:Object(_.d)(e),areIndexPricesLoaded:Object(N.c)(e),arePerpBalancesLoaded:Object(L.c)(e),currentPair:Object(I.e)(e),isUserInUsa:Object(M.c)(e),isWalletReady:Object(D.w)(e),pendingDepositsWithdrawals:Object(A.e)(e),perpetualBalances:Object(L.e)(e),walletAddress:Object(D.m)(e)}),e=>Object(u.b)({openSidebarModal:S.d},e))(G))},2251:function(e,t,a){e.exports={perpSidebar:"_3KUZeySmY1U88X3xyQv1Ks",sidebarBalances:"_3-tg6dWI8vBUaOsHnA7X1U",sidebarBalancesContent:"_1u19Luhi7IaCXdszLtAkGi",title:"_3UfO-6Hi3n9Y41LvrcEHFX",balanceItem:"_2BS4V30y_eVAAdakLbjwEi",balanceLoading:"IyJhxvIk65m4RYRywtW4v",balanceItemHighlight:"_4SbWxs7pJz_gQMGLy4fB3",tooltipWithTag:"_2NlBDV-Gxb252i5Eufbu6s",collateralization:"_1tApEXv1t_kvgguJ7owZYb","cell-tooltip":"_14E3vf4SPyDD_yeBAa2A7n","content-tooltip":"Tby_-2gMA4QjvrfmMPK47",buttons:"_3TAl1Dv7VBpe82LuCUORz-",scrollContainer:"_1yXlKkBOeyhfXY9uGeoJC2"}}}]);